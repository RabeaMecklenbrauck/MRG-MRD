---
title: "MRG MRD"
output: html_document
date: "2025-07-10"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load necessary libraries
add additional packages as necessary when additional packages are needed
```{r}
library(survminer)
library(survivalAnalysis)
library(magrittr)
library(gtsummary)
library(survival)
library(ggsurvfit)
library(tidyverse)
library(dplyr)
library(gtsummary)
library(readxl)
library(plyr)
library(cmprsk)
library(cowplot)
library(ggplot2)
library(AICcmodavg)
library(cmprsk)
```
Load the dataframe
Note: for simplicity reason we are naming the full dataframe "df" 
```{r}
df<- read_xlsx("/Users/maximilianbader/Library/Mobile Documents/com~apple~CloudDocs/Universitaet/AG Heuser/analysis/2025/MRDMRGMshared/Export data for R/250709_MRGM-Data_Analysis_v33_anonym.xlsx", na = "na")
```
For further analysis, transform all relevant variables to numbers]
```{r}
df$`Einschluss t1_oder_t2`<-as.numeric(df$`Einschluss t1_oder_t2`)
df$Tx_yes_no<-as.numeric(df$Tx_yes_no)
df$t1_MRD_Comutations_positive1_negative0<-as.numeric(df$t1_MRD_Comutations_positive1_negative0)
df$t1_MRD_MRGM_positive1_negative0<-as.numeric(df$t1_MRD_MRGM_positive1_negative0)
df$t2_MRD_Comutations_positive1_negative0<-as.numeric(df$t2_MRD_Comutations_positive1_negative0)
df$t2_MRD_MRGM_positive1_negative0<-as.numeric(df$t2_MRD_MRGM_positive1_negative0)
df$ELN<-as.numeric(df$ELN)
df$`CBF, NPM1, TP53, adverse`<-as.numeric(df$`CBF, NPM1, TP53, adverse`)
df$Age_at_ED<-as.numeric(df$Age_at_ED)
df$Sex<-as.numeric(df$Sex)
df$NPM1_code<-as.numeric(df$NPM1_code)
df$TP53_code<-as.numeric(df$TP53_code)
df$NPM1_code<-as.numeric(df$NPM1_code)
df$`t1_eingeschlossen 1 _ ausgeschlossen 0`<-as.numeric(df$`t1_eingeschlossen 1 _ ausgeschlossen 0`)
df$t2_eingeschlossen1_ausgeschlossen0<-as.numeric(df$t2_eingeschlossen1_ausgeschlossen0)
df$ECOG_Code<-as.numeric(df$ECOG_Code)
df$WBC_at_ED<-as.numeric(df$WBC_at_ED)
df$AML_Type<-as.numeric(df$AML_Type)
df$KT_complex<-as.numeric(df$KT_complex)
df$Hb_at_ED<-as.numeric(df$Hb_at_ED)
df$Platelets_at_ED<-as.numeric(df$Platelets_at_ED)
df$Type_of_consolidation_therapy<-as.numeric(df$Type_of_consolidation_therapy)
df$t1_MRD_MRGM_noASXL1<-as.numeric(df$t1_MRD_MRGM_noASXL1)
df$t2_MRD_MRGM_noASXL1<-as.numeric(df$t2_MRD_MRGM_noASXL1)
df$t1_FLT3_MRD<-as.numeric(df$t1_FLT3_MRD)
df$t2_FLT3_MRD<-as.numeric(df$t2_FLT3_MRD)
df$t1_NPM1_MRD<-as.numeric(df$t1_NPM1_MRD)
df$t2_NPM1_MRD<-as.numeric(df$t2_NPM1_MRD)
df$CIR_event<-as.numeric(df$CIR_event)
df$t1_MRD_ASXL1<-as.numeric(df$t1_MRD_ASXL1)
df$t1_MRD_VAF_ASXL1<-as.numeric(df$t1_MRD_VAF_ASXL1)
df$t1_MRD_BCOR<-as.numeric(df$t1_MRD_BCOR)
df$t1_MRD_VAF_BCOR<-as.numeric(df$t1_MRD_VAF_BCOR)
df$t1_MRD_EZH2<-as.numeric(df$t1_MRD_EZH2)
df$t1_MRD_VAF_EZH2<-as.numeric(df$t1_MRD_VAF_EZH2)
df$t1_MRD_RUNX1<-as.numeric(df$t1_MRD_RUNX1)
df$t1_MRD_VAF_RUNX1<-as.numeric(df$t1_MRD_VAF_RUNX1)
df$t1_MRD_SF3B1<-as.numeric(df$t1_MRD_SF3B1)
df$t1_MRD_VAF_SF3B1<-as.numeric(df$t1_MRD_VAF_SF3B1)
df$t1_MRD_SRSF2<-as.numeric(df$t1_MRD_SRSF2)
df$t1_MRD_VAF_SRSF2<-as.numeric(df$t1_MRD_VAF_SRSF2)
df$t1_MRD_STAG2<-as.numeric(df$t1_MRD_STAG2)
df$t1_MRD_VAF_STAG2<-as.numeric(df$t1_MRD_VAF_STAG2)
df$t1_MRD_U2AF1<-as.numeric(df$t1_MRD_U2AF1)
df$t1_MRD_VAF_U2AF1<-as.numeric(df$t1_MRD_VAF_U2AF1)
df$t1_MRD_ZRSR2<-as.numeric(df$t1_MRD_ZRSR2)
df$t1_MRD_VAF_ZRSR2<-as.numeric(df$t1_MRD_VAF_ZRSR2)
df$t2_MRD_ASXL1<-as.numeric(df$t2_MRD_ASXL1)
df$t2_MRD_VAF_ASXL1<-as.numeric(df$t2_MRD_VAF_ASXL1)
df$t2_MRD_BCOR<-as.numeric(df$t2_MRD_BCOR)
df$t2_MRD_VAF_BCOR<-as.numeric(df$t2_MRD_VAF_BCOR)
df$t2_MRD_EZH2<-as.numeric(df$t2_MRD_EZH2)
df$t2_MRD_VAF_EZH2<-as.numeric(df$t2_MRD_VAF_EZH2)
df$t2_MRD_RUNX1<-as.numeric(df$t2_MRD_RUNX1)
df$t2_MRD_VAF_RUNX1<-as.numeric(df$t2_MRD_VAF_RUNX1)
df$t2_MRD_SF3B1<-as.numeric(df$t2_MRD_SF3B1)
df$t2_MRD_VAF_SF3B1<-as.numeric(df$t2_MRD_VAF_SF3B1)
df$t2_MRD_SRSF2<-as.numeric(df$t2_MRD_SRSF2)
df$t2_MRD_VAF_SRSF2<-as.numeric(df$t2_MRD_VAF_SRSF2)
df$t2_MRD_STAG2<-as.numeric(df$t2_MRD_STAG2)
df$t2_MRD_VAF_STAG2<-as.numeric(df$t2_MRD_VAF_STAG2)
df$t2_MRD_U2AF1<-as.numeric(df$t2_MRD_U2AF1)
df$t2_MRD_VAF_U2AF1<-as.numeric(df$t2_MRD_VAF_U2AF1)
df$t2_MRD_ZRSR2<-as.numeric(df$t2_MRD_ZRSR2)
df$t2_MRD_VAF_ZRSR2<-as.numeric(df$t2_MRD_VAF_ZRSR2)
df$t1_MRD_Comutations_noDTA<-as.numeric(df$t1_MRD_Comutations_noDTA)
df$t2_MRD_Comutations_noDTA<-as.numeric(df$t2_MRD_Comutations_noDTA)
df$`DTA?`<-as.numeric(df$`DTA?`)
df$Sample_Material_PB_1_BM_2<-as.numeric(df$Sample_Material_PB_1_BM_2)
df$Sample_Material_t2_PB_1_BM_2<-as.numeric(df$Sample_Material_t2_PB_1_BM_2)
```

Create subsets for the following analysis
```{r}
MRD_MRGM=subset(df, df$`Einschluss t1_oder_t2`==1)
t1andt2=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1)
t1cohort=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1)
t2cohort=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1)
t1andt2=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1)
txonly=subset(df, df$`Einschluss t1_oder_t2`==1 & df$Tx_yes_no==1)
nontxonly=subset(df, df$`Einschluss t1_oder_t2`==1 & df$Tx_yes_no==0)
t1compositiv=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t1_MRD_Comutations_positive1_negative0==1)
t1comnegativ=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t1_MRD_Comutations_positive1_negative0==0)
t1mpositiv=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t1_MRD_MRGM_positive1_negative0==1)
t1mnegativ=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t1_MRD_MRGM_positive1_negative0==0)
t2compositiv=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t2_MRD_Comutations_positive1_negative0==1)
t2comnegativ=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t2_MRD_Comutations_positive1_negative0==0)
t2mpositiv=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t2_MRD_MRGM_positive1_negative0==1)
t2mnegativ=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t2_MRD_MRGM_positive1_negative0==0)
noNPM1=subset(df, `Einschluss t1_oder_t2`==1 & NPM1_code==0)
noTP53=subset(df, `Einschluss t1_oder_t2`==1 & TP53_code==0)
noNPM1noTP53=subset(df, `Einschluss t1_oder_t2`==1 & NPM1_code==0 & TP53_code==0)
ELNintermediate=subset(df, `Einschluss t1_oder_t2`==1 & ELN==2)
noTP53_Tx_only=subset(df, `Einschluss t1_oder_t2`==1 & TP53_code==0 & Tx_yes_no==1)
noNPM1noTP53_Tx_only=subset(df, `Einschluss t1_oder_t2`==1 & NPM1_code==0 & TP53_code==0 & Tx_yes_no==1)
overlapt1pos=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$t1_MRD_MRGM_positive1_negative0==1)
overlapchemoonlyt1pos=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$Type_of_consolidation_therapy==0 & df$t1_MRD_MRGM_positive1_negative0==1)
overlaptxonlyt1pos=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$Type_of_consolidation_therapy==1 & df$t1_MRD_MRGM_positive1_negative0==1)
overlapchemotxt1pos=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$Type_of_consolidation_therapy==2 & df$t1_MRD_MRGM_positive1_negative0==1)
overlapt1posnoASXL1=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$t1_MRD_MRGM_noASXL1==1)
t1FLT3mrdpos=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$t1_FLT3_MRD==1)
t1FLT3mrdneg=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$t1_FLT3_MRD==0)
t2FLT3mrdpos=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$t1_FLT3_MRD==1)
t2FLT3mrdneg=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$t1_FLT3_MRD==0)
t1NPM1mrdpos=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$t1_NPM1_MRD==1)
t1NPM1mrdneg=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$t1_NPM1_MRD==0)
t2NPM1mrdpos=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$t1_NPM1_MRD==1)
t2NPM1mrdneg=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$t1_NPM1_MRD==0)
t1cohortnonpm1=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$NPM1_code !=1)
t2cohortnonpm1=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$NPM1_code !=1)
overlapt1posnonpm1=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$t1_MRD_MRGM_positive1_negative0==1 & df$NPM1_code !=1)
onlyt1=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$t2_eingeschlossen1_ausgeschlossen0!=1)
onlyt2=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`!=1 & df$t2_eingeschlossen1_ausgeschlossen0==1)
t1txonly=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$Tx_yes_no==1)
t2txonly=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$Tx_yes_no==1)
t1chemoonly=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$Type_of_consolidation_therapy==0)
t2chemoonly=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$Type_of_consolidation_therapy==0)
t1pbonly=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$Sample_Material_PB_1_BM_2==1)
t1bmonly=subset(df, df$`Einschluss t1_oder_t2`==1 & df$`t1_eingeschlossen 1 _ ausgeschlossen 0`==1 & df$Sample_Material_PB_1_BM_2==2)
t2pbonly=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$Sample_Material_t2_PB_1_BM_2==1)
t2bmonly=subset(df, df$`Einschluss t1_oder_t2`==1 & df$t2_eingeschlossen1_ausgeschlossen0==1 & df$Sample_Material_t2_PB_1_BM_2==2)
```
Further subsets to be added if needed.

The next step is to develop a consort diagram: How many patients were screened, how many were excluded and why. This is probably only possible with the original excel sheet, please check.

Table 1.1: Patient characteristics - t1 only
```{r} 
nrow(t1cohort)
#age
summary(t1cohort$Age_at_ED)
summary(t1mpositiv$Age_at_ED)
summary(t1mnegativ$Age_at_ED)
wilcox.test(t1mpositiv$Age_at_ED, t1mnegativ$Age_at_ED)
wilcox.test(t1cohort$Age_at_ED~ t1cohort$t1_MRD_MRGM_positive1_negative0)
#sex
table(t1cohort$Sex, t1cohort$t1_MRD_MRGM_positive1_negative0)
table_sex<-table(t1cohort$Sex, t1cohort$t1_MRD_MRGM_positive1_negative0)
chisq.test(table_sex)
#AML_type
table(t1cohort$AML_Type, t1cohort$t1_MRD_MRGM_positive1_negative0)
table_AMLtype<-table(t1cohort$AML_Type, t1cohort$t1_MRD_MRGM_positive1_negative0)
chisq.test(table_AMLtype)
fisher.test(table_AMLtype) #Fisher-Test weil Werte <5? 
#ecog
table(t1cohort$ECOG_Code, t1cohort$t1_MRD_MRGM_positive1_negative0)
table_ECOG<-table(t1cohort$ECOG_Code, t1cohort$t1_MRD_MRGM_positive1_negative0)
chisq.test(table_ECOG)
fisher.test(table_ECOG) #Fisher-Test weil Werte <5? 
#karyotype
table(t1cohort$KT_complex, t1cohort$t1_MRD_MRGM_positive1_negative0)
table_KTcomplex<-table(t1cohort$KT_complex, t1cohort$t1_MRD_MRGM_positive1_negative0)
chisq.test(table_KTcomplex)
fisher.test(table_KTcomplex) #Fisher-Test weil Werte <5? 
#wbc
summary(t1cohort$WBC_at_ED)
summary(t1mpositiv$WBC_at_ED)
summary(t1mnegativ$WBC_at_ED)
wilcox.test(t1mpositiv$WBC_at_ED, t1mnegativ$WBC_at_ED)
wilcox.test(t1cohort$WBC_at_ED~ t1cohort$t1_MRD_MRGM_positive1_negative0)
#Hgb
summary(t1cohort$Hb_at_ED)
summary(t1mpositiv$Hb_at_ED)
summary(t1mnegativ$Hb_at_ED)
wilcox.test(t1mpositiv$Hb_at_ED, t1mnegativ$Hb_at_ED)
wilcox.test(t1cohort$Hb_at_ED~ t1cohort$t1_MRD_MRGM_positive1_negative0)
#Plt
summary(t1cohort$Platelets_at_ED)
summary(t1mpositiv$Platelets_at_ED)
summary(t1mnegativ$Platelets_at_ED)
wilcox.test(t1mpositiv$Platelets_at_ED, t1mnegativ$Platelets_at_ED)
wilcox.test(t1cohort$Platelets_at_ED~ t1cohort$t1_MRD_MRGM_positive1_negative0)
```
Table 1.2: Patient characteristics - t2 only
```{r}
nrow(t2cohort)
#age
summary(t2cohort$Age_at_ED)
summary(t2mpositiv$Age_at_ED)
summary(t2mnegativ$Age_at_ED)
wilcox.test(t2mpositiv$Age_at_ED, t2mnegativ$Age_at_ED)
#sex
table(t2cohort$Sex, t2cohort$t2_MRD_MRGM_positive1_negative0)
table_sex_t2<-table(t2cohort$Sex, t2cohort$t2_MRD_MRGM_positive1_negative0)
chisq.test(table_sex_t2)
#AML_type
table(t2cohort$AML_Type, t2cohort$t2_MRD_MRGM_positive1_negative0)
table_AMLtype_t2<-table(t2cohort$AML_Type, t2cohort$t2_MRD_MRGM_positive1_negative0)
chisq.test(table_AMLtype_t2)
fisher.test(table_AMLtype_t2) #Fisher-Test weil Werte <5? 
#ecog
table(t2cohort$ECOG_Code, t2cohort$t2_MRD_MRGM_positive1_negative0)
table_ECOG_t2<-table(t2cohort$ECOG_Code, t2cohort$t2_MRD_MRGM_positive1_negative0)
chisq.test(table_ECOG_t2)
fisher.test(table_ECOG_t2) #Fisher-Test weil Werte <5? 
#karyotype
table(t2cohort$KT_complex, t2cohort$t2_MRD_MRGM_positive1_negative0)
table_KTcomplex_t2<-table(t2cohort$KT_complex, t2cohort$t2_MRD_MRGM_positive1_negative0)
chisq.test(table_KTcomplex_t2)
fisher.test(table_KTcomplex_t2) #Fisher-Test weil Werte <5? 
#wbc
summary(t2cohort$WBC_at_ED)
summary(t2mpositiv$WBC_at_ED)
summary(t2mnegativ$WBC_at_ED)
wilcox.test(t2mpositiv$WBC_at_ED, t2mnegativ$WBC_at_ED)
#Hgb
summary(t2cohort$Hb_at_ED)
summary(t2mpositiv$Hb_at_ED)
summary(t2mnegativ$Hb_at_ED)
wilcox.test(t2mpositiv$Hb_at_ED, t2mnegativ$Hb_at_ED)
#Plt
summary(t2cohort$Platelets_at_ED)
summary(t2mpositiv$Platelets_at_ED)
summary(t2mnegativ$Platelets_at_ED)
wilcox.test(t2mpositiv$Platelets_at_ED, t2mnegativ$Platelets_at_ED)
```

Table 1.3.1: Patient characteristics - All patients
```{r}
nrow(MRD_MRGM)
#age
summary(MRD_MRGM$Age_at_ED)
#sex
table(MRD_MRGM$Sex)
#AML_type
table(MRD_MRGM$AML_Type)
#ecog
table(MRD_MRGM$ECOG_Code)
#karyotype
table(MRD_MRGM$KT_complex)
#wbc
summary(MRD_MRGM$WBC_at_ED)
#Hgb
summary(MRD_MRGM$Hb_at_ED)
#Plt
summary(MRD_MRGM$Platelets_at_ED)
```
Table 1.3.2: Patient characteristics - Patients with MRD measurements at both time points
```{r}
nrow(t1andt2)
#age
summary(t1andt2$Age_at_ED)
#sex
table(t1andt2$Sex)
#AML_type
table(t1andt2$AML_Type)
#ecog
table(t1andt2$ECOG_Code)
#karyotype
table(t1andt2$KT_complex)
#wbc
summary(t1andt2$WBC_at_ED)
#Hgb
summary(t1andt2$Hb_at_ED)
#Plt
summary(t1andt2$Platelets_at_ED)
```

Supplemental Table 1: Incidence of MRG mutations.
```{r}
table (df$ASXL1)
table (df$BCOR)
table(df$EZH2)
table(df$RUNX1)
table(df$SF3B1)
table(df$SRSF2)
table(df$STAG2)
table(df$U2AF1)
table(df$ZRSR2)
```
Mutational landscape MRGM t1cohort
```{r}
table (t1cohort$t1_MRD_ASXL1)
table (t1cohort$t1_MRD_BCOR)
table(t1cohort$t1_MRD_EZH2)
table(t1cohort$t1_MRD_RUNX1)
table(t1cohort$t1_MRD_SF3B1)
table(t1cohort$t1_MRD_SRSF2)
table(t1cohort$t1_MRD_STAG2)
table(t1cohort$t1_MRD_U2AF1)
table(t1cohort$t1_MRD_ZRSR2)
```
Mutational landscape MRGM t2cohort
```{r}
table (t2cohort$t2_MRD_ASXL1)
table (t2cohort$t2_MRD_BCOR)
table(t2cohort$t2_MRD_EZH2)
table(t2cohort$t2_MRD_RUNX1)
table(t2cohort$t2_MRD_SF3B1)
table(t2cohort$t2_MRD_SRSF2)
table(t2cohort$t2_MRD_STAG2)
table(t2cohort$t2_MRD_U2AF1)
table(t2cohort$t2_MRD_ZRSR2)
```


Supplemental table 2: Co-mutations > code see above
```{r}
df = MRD_MRGM
table(df$ASXL2_code)
table(df$ABCA1_code)
table(df$ATRX_code)
table(df$BCORL1_code)
table(df$CALR_code)
table(df$CBL_code)
table(df$CEBPA_code)
table(df$CSF3R_code)
table(df$DDX41_code)
table(df$DNMT3A_code)
table(df$ETNK1_code)
table(df$ETV6_code)
table(df$FLT3_code)
table(df$GATA2_code)
table(df$IDH1_code)
table(df$IDH2_code)
table(df$JAK2_code)
table(df$KDM6A_code)
table(df$KIT_code)
table(df$KMT2A_code)
table(df$KRAS_code)
table(df$MYC_code)
table(df$NF1_code)
table(df$NPM1_code)
table(df$NRAS_code)
table(df$PHF6_code)
table(df$PTPN11_code)
table(df$RAD21_code)
table(df$SETBP1_code)
table(df$SMC1A_code)
table(df$STAG1_code)
table(df$TET2_code)
table(df$TP53_code)
table(df$WT1_code)
table(df$ZBTB7A_code)
table(df$FLT3_ITD)
table(df$SMC3_code)
```

Calculate the log fold change between the VAFS at ED and t1 or t2. For that we need a variable with VAF at ED for gene 1, 2 etc....
Define all variables as numeric
```{r}
t1cohort$VAF_gene1_t1<-as.numeric(t1cohort$VAF_gene1_t1)
t1cohort$t1_g1_VAF_ED<-as.numeric(t1cohort$t1_g1_VAF_ED)
t1cohort$VAF_gene2_t1<-as.numeric(t1cohort$VAF_gene2_t1)
t1cohort$t1_g2_VAF_ED<-as.numeric(t1cohort$t1_g2_VAF_ED)
t1cohort$VAF_gene3_t1<-as.numeric(t1cohort$VAF_gene3_t1)
t1cohort$t1_g3_VAF_ED<-as.numeric(t1cohort$t1_g3_VAF_ED)
t1cohort$VAF_gene4_t1<-as.numeric(t1cohort$VAF_gene4_t1)
t1cohort$t1_g4_VAF_ED<-as.numeric(t1cohort$t1_g4_VAF_ED)

```
Define the FC for each variable. 
```{r}
t1cohort$FC_T1_g1 = t1cohort$t1_g1_VAF_ED/t1cohort$VAF_gene1_t1
t1cohort$FC_T1_g2 = t1cohort$t1_g2_VAF_ED/t1cohort$VAF_gene2_t1
t1cohort$FC_T1_g3 = t1cohort$t1_g3_VAF_ED/t1cohort$VAF_gene3_t1
t1cohort$FC_T1_g4 = t1cohort$t1_g4_VAF_ED/t1cohort$VAF_gene4_t1
```

Define a new variable which has the maximum LogFC.
```{r}
t1cohort$FC_T1_g1<-as.numeric(t1cohort$FC_T1_g1)
t1cohort$FC_T1_g2<-as.numeric(t1cohort$FC_T1_g2)
t1cohort$FC_T1_g3<-as.numeric(t1cohort$FC_T1_g3)
t1cohort$FC_T1_g4<-as.numeric(t1cohort$FC_T1_g4)
t1cohort$MaxFC <- pmax(t1cohort$FC_T1_g1, t1cohort$FC_T1_g2, t1cohort$FC_T1_g3, t1cohort$FC_T1_g4, na.rm = TRUE)
summary(t1cohort$MaxFC)
```

```{r}
t1cohort<-t1cohort%>%
  mutate(FC_gr1 = case_when(
    MaxFC <= 100 ~ "1",
    MaxFC > 100  ~ "0",
    is.na(MaxFC) ~ "na"))
t1cohort$FC_gr1<-as.numeric(t1cohort$FC_gr1)
table(t1cohort$FC_gr1)
```
```{r}
t1cohort<-t1cohort%>%
  mutate(FC_gr2 = case_when(
    MaxFC <= 1000 ~ "1",
    MaxFC >1000  ~ "0",
    is.na(MaxFC) ~ "na"))
t1cohort$FC_gr2<-as.numeric(t1cohort$FC_gr2)
table(t1cohort$FC_gr2)
```
```{r}
t1cohort<-t1cohort%>%
  mutate(FC_gr3= case_when(
    MaxFC <= 10000 ~ "1",
    MaxFC >10000   ~ "0",
    is.na(MaxFC) ~ "na"))
t1cohort$FC_gr3<-as.numeric(t1cohort$FC_gr3)
table(t1cohort$FC_gr3)
```

Define all variables as numeric
```{r}
t2cohort$VAF_gene1_t2<-as.numeric(t2cohort$VAF_gene1_t2)
t2cohort$t2_g1_VAF_ED<-as.numeric(t2cohort$t2_g1_VAF_ED)
t2cohort$VAF_gene2_t2<-as.numeric(t2cohort$VAF_gene2_t2)
t2cohort$t2_g2_VAF_ED<-as.numeric(t2cohort$t2_g2_VAF_ED)
t2cohort$VAF_gene3_t2<-as.numeric(t2cohort$VAF_gene3_t2)
t2cohort$t2_g3_VAF_ED<-as.numeric(t2cohort$t2_g3_VAF_ED)
t2cohort$VAF_gene4_t2<-as.numeric(t2cohort$VAF_gene4_t2)
t2cohort$t2_g4_VAF_ED<-as.numeric(t2cohort$t2_g4_VAF_ED)

```
Define the FC for each variable. 
```{r}
t2cohort$FC_T2_g1 = t2cohort$t2_g1_VAF_ED/t2cohort$VAF_gene1_t2
t2cohort$FC_T2_g2 = t2cohort$t2_g2_VAF_ED/t2cohort$VAF_gene2_t2
t2cohort$FC_T2_g3 = t2cohort$t2_g3_VAF_ED/t2cohort$VAF_gene3_t2
t2cohort$FC_T2_g4 = t2cohort$t2_g4_VAF_ED/t2cohort$VAF_gene4_t2
```

Define a new variable which has the maximum LogFC.
```{r}
t2cohort$FC_T2_g1<-as.numeric(t2cohort$FC_T2_g1)
t2cohort$FC_T2_g2<-as.numeric(t2cohort$FC_T2_g2)
t2cohort$FC_T2_g3<-as.numeric(t2cohort$FC_T2_g3)
t2cohort$FC_T2_g4<-as.numeric(t2cohort$FC_T2_g4)
t2cohort$MaxFC_t2 <- pmax(t2cohort$FC_T2_g1, t2cohort$FC_T2_g2, t2cohort$FC_T2_g3, t2cohort$FC_T2_g4, na.rm = TRUE)
summary(t2cohort$MaxFC_t2)
```

```{r}
t2cohort<-t2cohort%>%
  mutate(FC_gr1_t2 = case_when(
    MaxFC_t2 <= 100 ~ "1",
    MaxFC_t2 > 100  ~ "0",
    is.na(MaxFC_t2) ~ "na"))
t2cohort$FC_gr1_t2<-as.numeric(t2cohort$FC_gr1_t2)
table(t2cohort$FC_gr1_t2)
```
```{r}
t2cohort<-t2cohort%>%
  mutate(FC_gr2_t2 = case_when(
    MaxFC_t2 <= 1000 ~ "1",
    MaxFC_t2 >1000  ~ "0",
    is.na(MaxFC_t2) ~ "na"))
t2cohort$FC_gr2_t2<-as.numeric(t2cohort$FC_gr2_t2)
table(t2cohort$FC_gr2_t2)
```
```{r}
t2cohort<-t2cohort%>%
  mutate(FC_gr3_t2 = case_when(
    MaxFC_t2 <= 10000 ~ "1",
    MaxFC_t2 >10000   ~ "0",
    is.na(MaxFC_t2) ~ "na"))
t2cohort$FC_gr3_t2<-as.numeric(t2cohort$FC_gr3_t2)
table(t2cohort$FC_gr3_t2)
```
Figure 1
A RFS
```{r}
fit_MRD_MRGM<- survfit(Surv(RFS_years, RFS_status)~noNPM1noTP53_Tx_only$m1_MRD_positive, data=noNPM1noTP53_Tx_only)
png("/Users/maximilianbader/Library/Mobile Documents/com~apple~CloudDocs/UniversitÃ¤t/AG Heuser/analysis/figures231112/231112_OS_All_MRGM_no_TP53_no_NPM1_Tx_only_v1.png", units="in", width = 9, height = 6.3, res=600)
ggsurv <- ggsurvplot(
  fit_MRD_MRGM,                     # survfit object with calculated statistics.
  data = noNPM1noTP53_Tx_only ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
dev.off()                                                                                                                                                                                                      
```
P with logrank and cox regression
```{r}
survdiff(Surv(RFS_years, RFS_status)~noNPM1noTP53_Tx_only$m1_MRD_positive, data=noNPM1noTP53_Tx_only)
coxph(Surv(RFS_years, RFS_status) ~ oNPM1noTP53_Tx_only$m1_MRD_positive, data=noNPM1noTP53_Tx_only) %>% 
  tbl_regression(exp = TRUE)
```

OS t1cohort
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohort$t1_MRD_MRGM_positive1_negative0, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohort$t1_MRD_MRGM_positive1_negative0, data=t1cohort)
coxph(Surv(OS_years, OS_status) ~ t1cohort$t1_MRD_MRGM_positive1_negative0, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_MRGM_positive1_negative0, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_MRGM_positive1_negative0, data=t1cohort)
coxph(Surv(RFS_years, RFS_status) ~ t1cohort$t1_MRD_MRGM_positive1_negative0, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort
```{r}
ci.all<-cuminc(ftime=t1cohort$RFS_years,fstatus=t1cohort$CIR_event,group=t1cohort$t1_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohort$RFS_years, t1cohort$CIR_event == 1, t1cohort$t1_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t2cohort
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohort$t2_MRD_MRGM_positive1_negative0, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohort$t2_MRD_MRGM_positive1_negative0, data=t2cohort)
coxph(Surv(OS_years, OS_status) ~ t2cohort$t2_MRD_MRGM_positive1_negative0, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_MRGM_positive1_negative0, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_MRGM_positive1_negative0, data=t2cohort)
coxph(Surv(RFS_years, RFS_status) ~ t2cohort$t2_MRD_MRGM_positive1_negative0, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort
```{r}
ci.all<-cuminc(ftime=t2cohort$RFS_years,fstatus=t2cohort$CIR_event,group=t2cohort$t2_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohort$RFS_years, t2cohort$CIR_event == 1, t2cohort$t2_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```



OS Overlap t1t2, t1 MRD+ -> Conversion as prognostic marker?
```{r}
fit_overlapt1t2conversion<- survfit(Surv(OS_years, OS_status)~overlapt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapt1pos)
ggsurv <- ggsurvplot(
  fit_overlapt1t2conversion,                     # survfit object with calculated statistics.
  data = overlapt1pos ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~overlapt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapt1pos)
coxph(Surv(OS_years, OS_status) ~ overlapt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapt1pos) %>% 
  tbl_regression(exp = TRUE)
```
RFS Overlap t1t2, t1 MRD+ -> Conversion as prognostic marker?
```{r}
fit_overlapt1t2conversion<- survfit(Surv(RFS_years, RFS_status)~overlapt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapt1pos)
ggsurv <- ggsurvplot(
  fit_overlapt1t2conversion,                     # survfit object with calculated statistics.
  data = overlapt1pos ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~overlapt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapt1pos)
coxph(Surv(RFS_years, RFS_status) ~ overlapt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapt1pos) %>% 
  tbl_regression(exp = TRUE)
```
CIR Overlap t1t2, t1 MRD+ -> Conversion as prognostic marker?
```{r}
ci.all<-cuminc(ftime=overlapt1pos$RFS_years,fstatus=overlapt1pos$CIR_event,group=overlapt1pos$t2_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(overlapt1pos$RFS_years, overlapt1pos$CIR_event == 1, overlapt1pos$t2_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```



OS Overlap t1t2, Chemo only t1 MRD+ -> Conversion as prognostic marker?
```{r}
fit_overlapchemoonlyt1t2conversion<- survfit(Surv(OS_years, OS_status)~overlapchemoonlyt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapchemoonlyt1pos)
ggsurv <- ggsurvplot(
  fit_overlapchemoonlyt1t2conversion,                     # survfit object with calculated statistics.
  data = overlapchemoonlyt1pos ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
ERROR, because ONLY positive patients! nothing to compare. 

Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~overlapchemoonlyt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapchemoonlyt1pos)
coxph(Surv(OS_years, OS_status) ~ overlapchemoonlyt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapchemoonlyt1pos) %>% 
  tbl_regression(exp = TRUE)
```

OS Overlap t1t2, Tx only t1 MRD+ -> Conversion as prognostic marker?
```{r}
fit_overlaptxonlyt1t2conversion<- survfit(Surv(OS_years, OS_status)~overlaptxonlyt1pos$t2_MRD_MRGM_positive1_negative0, data=overlaptxonlyt1pos)
ggsurv <- ggsurvplot(
  fit_overlaptxonlyt1t2conversion,                     # survfit object with calculated statistics.
  data = overlaptxonlyt1pos ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
 Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~overlaptxonlyt1pos$t2_MRD_MRGM_positive1_negative0, data=overlaptxonlyt1pos)
coxph(Surv(OS_years, OS_status) ~ overlaptxonlyt1pos$t2_MRD_MRGM_positive1_negative0, data=overlaptxonlyt1pos) %>% 
  tbl_regression(exp = TRUE)
```
RFS Overlap t1t2, Tx only t1 MRD+ -> Conversion as prognostic marker?
```{r}
fit_overlaptxonlyt1t2conversion<- survfit(Surv(RFS_years, RFS_status)~overlaptxonlyt1pos$t2_MRD_MRGM_positive1_negative0, data=overlaptxonlyt1pos)
ggsurv <- ggsurvplot(
  fit_overlaptxonlyt1t2conversion,                     # survfit object with calculated statistics.
  data = overlaptxonlyt1pos ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~overlaptxonlyt1pos$t2_MRD_MRGM_positive1_negative0, data=overlaptxonlyt1pos)
coxph(Surv(RFS_years, RFS_status) ~ overlaptxonlyt1pos$t2_MRD_MRGM_positive1_negative0, data=overlaptxonlyt1pos) %>% 
  tbl_regression(exp = TRUE)
```
CIR Overlap t1t2, Tx only t1 MRD+ -> Conversion as prognostic marker?
```{r}
ci.all<-cuminc(ftime=overlaptxonlyt1pos$RFS_years,fstatus=overlaptxonlyt1pos$CIR_event,group=overlaptxonlyt1pos$t2_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(overlaptxonlyt1pos$RFS_years, overlaptxonlyt1pos$CIR_event == 1, overlaptxonlyt1pos$t2_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```



OS Overlap t1t2, Chemo + Tx t1 MRD+ -> Conversion as prognostic marker?
```{r}
fit_overlapchemotxt1t2conversion<- survfit(Surv(OS_years, OS_status)~overlapchemotxt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapchemotxt1pos)
ggsurv <- ggsurvplot(
  fit_overlapchemotxt1t2conversion,                     # survfit object with calculated statistics.
  data = overlapchemotxt1pos ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
 ERROR: No deads!
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~overlapchemotxt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapchemotxt1pos)
coxph(Surv(OS_years, OS_status) ~ overlapchemotxt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapchemotxt1pos) %>% 
  tbl_regression(exp = TRUE)
```
RFS Overlap t1t2, Chemo and Tx, t1 MRD+ -> Conversion as prognostic marker?
```{r}
fit_overlapchemotxt1t2conversion<- survfit(Surv(RFS_years, RFS_status)~overlapchemotxt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapchemotxt1pos)
ggsurv <- ggsurvplot(
  fit_overlapchemotxt1t2conversion,                     # survfit object with calculated statistics.
  data = overlapchemotxt1pos ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
ERROR: No relapse!
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~overlapchemotxt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapchemotxt1pos)
coxph(Surv(RFS_years, RFS_status) ~ overlapchemotxt1pos$t2_MRD_MRGM_positive1_negative0, data=overlapchemotxt1pos) %>% 
  tbl_regression(exp = TRUE)
```
No relapse!


OS t1cohort without ASXL1
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohort$t1_MRD_MRGM_noASXL1, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohort$t1_MRD_MRGM_noASXL1, data=t1cohort)
coxph(Surv(OS_years, OS_status) ~ t1cohort$t1_MRD_MRGM_noASXL1, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort without ASXL1
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_MRGM_noASXL1, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_MRGM_noASXL1, data=t1cohort)
coxph(Surv(RFS_years, RFS_status) ~ t1cohort$t1_MRD_MRGM_noASXL1, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1 cohort without ASXL1
```{r}
ci.all<-cuminc(ftime=t1cohort$RFS_years,fstatus=t1cohort$CIR_event,group=t1cohort$t1_MRD_MRGM_noASXL1)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohort$RFS_years, t1cohort$CIR_event == 1, t1cohort$t1_MRD_MRGM_noASXL1)
summary(fine_gray_test)

```


OS t2cohort without ASXL1
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohort$t2_MRD_MRGM_noASXL1, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohort$t2_MRD_MRGM_noASXL1, data=t2cohort)
coxph(Surv(OS_years, OS_status) ~ t2cohort$t2_MRD_MRGM_noASXL1, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort without ASXL1
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_MRGM_noASXL1, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_MRGM_noASXL1, data=t2cohort)
coxph(Surv(RFS_years, RFS_status) ~ t2cohort$t2_MRD_MRGM_noASXL1, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2 cohort without ASXL1
```{r}
ci.all<-cuminc(ftime=t2cohort$RFS_years,fstatus=t2cohort$CIR_event,group=t2cohort$t2_MRD_MRGM_noASXL1)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohort$RFS_years, t2cohort$CIR_event == 1, t2cohort$t2_MRD_MRGM_noASXL1)
summary(fine_gray_test)

```


OS Overlap t1t2, t1 MRD+ no ASXL1 -> Conversion as prognostic marker?
```{r}
fit_overlapt1t2conversionnoASXL1<- survfit(Surv(OS_years, OS_status)~overlapt1posnoASXL1$t2_MRD_MRGM_noASXL1, data=overlapt1posnoASXL1)
ggsurv <- ggsurvplot(
  fit_overlapt1t2conversionnoASXL1,                     # survfit object with calculated statistics.
  data = overlapt1posnoASXL1 ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~overlapt1posnoASXL1$t2_MRD_MRGM_noASXL1, data=overlapt1posnoASXL1)
coxph(Surv(OS_years, OS_status) ~ overlapt1posnoASXL1$t2_MRD_MRGM_noASXL1, data=overlapt1posnoASXL1) %>% 
  tbl_regression(exp = TRUE)
```
RFS Overlap t1t2, t1 MRD+ no ASXL1 -> Conversion as prognostic marker?
```{r}
fit_overlapt1t2conversionnoASXL1<- survfit(Surv(RFS_years, RFS_status)~overlapt1posnoASXL1$t2_MRD_MRGM_noASXL1, data=overlapt1posnoASXL1)
ggsurv <- ggsurvplot(
  fit_overlapt1t2conversionnoASXL1,                     # survfit object with calculated statistics.
  data = overlapt1posnoASXL1 ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~overlapt1posnoASXL1$t2_MRD_MRGM_noASXL1, data=overlapt1posnoASXL1)
coxph(Surv(RFS_years, RFS_status) ~ overlapt1posnoASXL1$t2_MRD_MRGM_noASXL1, data=overlapt1posnoASXL1) %>% 
  tbl_regression(exp = TRUE)
```
CIR Overlap t1t2, t1 MRD+ no ASXL1 -> Conversion as prognostic marker?
```{r}
ci.all<-cuminc(ftime=overlapt1posnoASXL1$RFS_years,fstatus=overlapt1posnoASXL1$CIR_event,group=overlapt1posnoASXL1$t2_MRD_MRGM_noASXL1)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(overlapt1posnoASXL1$RFS_years, overlapt1posnoASXL1$CIR_event == 1, overlapt1posnoASXL1$t2_MRD_MRGM_noASXL1)
summary(fine_gray_test)

```

OS t1cohort - FLT3 MRD pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohort$t1_FLT3_MRD, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohort$t1_FLT3_MRD, data=t1cohort)
coxph(Surv(OS_years, OS_status) ~ t1cohort$t1_FLT3_MRD, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohort$t1_FLT3_MRD, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohort$t1_FLT3_MRD, data=t1cohort)
coxph(Surv(RFS_years, RFS_status) ~ t1cohort$t1_FLT3_MRD, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort
```{r}
ci.all<-cuminc(ftime=t1cohort$RFS_years,fstatus=t1cohort$CIR_event,group=t1cohort$t1_FLT3_MRD)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohort$RFS_years, t1cohort$CIR_event == 1, t1cohort$t1_FLT3_MRD)
summary(fine_gray_test)

```

OS t2cohort - FLT3 MRD pos. vs. neg. - Error: all negative!
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohort$t2_FLT3_MRD, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohort$t2_FLT3_MRD, data=t2cohort)
coxph(Surv(OS_years, OS_status) ~ t2cohort$t2_FLT3_MRD, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort FLT3 MRD pos. vs. neg. - Error: all negative!
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohort$t2_FLT3_MRD, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohort$t2_FLT3_MRD, data=t2cohort)
coxph(Surv(RFS_years, RFS_status) ~ t2cohort$t2_FLT3_MRD, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort FLT3 MRD pos. vs. neg. - Error: all negative!
```{r}
ci.all<-cuminc(ftime=t2cohort$RFS_years,fstatus=t2cohort$CIR_event,group=t2cohort$t2_FLT3_MRD)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohort$RFS_years, t2cohort$CIR_event == 1, t2cohort$t2_FLT3_MRD)
summary(fine_gray_test)

```

OS t1cohort - NPM1 MRD pos vs. neg. - 14 pos vs 2 neg!
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohort$t1_NPM1_MRD, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohort$t1_NPM1_MRD, data=t1cohort)
coxph(Surv(OS_years, OS_status) ~ t1cohort$t1_NPM1_MRD, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort NPM1 pos vs neg
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohort$t1_NPM1_MRD, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohort$t1_NPM1_MRD, data=t1cohort)
coxph(Surv(RFS_years, RFS_status) ~ t1cohort$t1_NPM1_MRD, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort NPM1 pos vs. neg
```{r}
ci.all<-cuminc(ftime=t1cohort$RFS_years,fstatus=t1cohort$CIR_event,group=t1cohort$t1_NPM1_MRD)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohort$RFS_years, t1cohort$CIR_event == 1, t1cohort$t1_NPM1_MRD)
summary(fine_gray_test)

```

OS t2cohort - NPM1 MRD pos. vs. neg. - Error: all negative
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohort$t2_NPM1_MRD, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohort$t2_NPM1_MRD, data=t2cohort)
coxph(Surv(OS_years, OS_status) ~ t2cohort$t2_NPM1_MRD, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort - NPM1 MRD pos. vs. neg.  - Error: all negative
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohort$t2_NPM1_MRD, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohort$t2_NPM1_MRD, data=t2cohort)
coxph(Surv(RFS_years, RFS_status) ~ t2cohort$t2_NPM1_MRD, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort - NPM1 MRD pos. vs. neg. - Error: all negative
```{r}
ci.all<-cuminc(ftime=t2cohort$RFS_years,fstatus=t2cohort$CIR_event,group=t2cohort$t2_NPM1_MRD)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohort$RFS_years, t2cohort$CIR_event == 1, t2cohort$t2_NPM1_MRD)
summary(fine_gray_test)

```





OS t1FLT3mrdpos -> t1 FLT3 MRD+ MRGM pos vs. neg  -> 6 Pts!
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1FLT3mrdpos$t1_MRD_MRGM_positive1_negative0, data=t1FLT3mrdpos)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1FLT3mrdpos,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1FLT3mrdpos$t1_MRD_MRGM_positive1_negative0, data=t1FLT3mrdpos)
coxph(Surv(OS_years, OS_status) ~ t1FLT3mrdpos$t1_MRD_MRGM_positive1_negative0, data=t1FLT3mrdpos) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1FLT3mrdpos -> t1 FLT3 MRD+ MRGM pos vs. neg -> 6 Pts!
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1FLT3mrdpos$t1_MRD_MRGM_positive1_negative0, data=t1FLT3mrdpos)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1FLT3mrdpos,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1FLT3mrdpos$t1_MRD_MRGM_positive1_negative0, data=t1FLT3mrdpos)
coxph(Surv(RFS_years, RFS_status) ~ t1FLT3mrdpos$t1_MRD_MRGM_positive1_negative0, data=t1FLT3mrdpos) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1FLT3mrdpos -> t1 FLT3 MRD+ MRGM pos vs. neg
```{r}
ci.all<-cuminc(ftime=t1FLT3mrdpos$RFS_years,fstatus=t1FLT3mrdpos$CIR_event,group=t1FLT3mrdpos$t1_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1FLT3mrdpos$RFS_years, t1FLT3mrdpos$CIR_event == 1, t1FLT3mrdpos$t1_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t1FLT3mrdneg -> t1 FLT3 MRD- MRGM pos vs. neg -> 8 pos vs. 1 neg.
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1FLT3mrdneg$t1_MRD_MRGM_positive1_negative0, data=t1FLT3mrdneg)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1FLT3mrdneg,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1FLT3mrdneg$t1_MRD_MRGM_positive1_negative0, data=t1FLT3mrdneg)
coxph(Surv(OS_years, OS_status) ~ t1FLT3mrdneg$t1_MRD_MRGM_positive1_negative0, data=t1FLT3mrdneg) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1FLT3mrdneg -> t1 FLT3 MRD- MRGM pos vs. neg -> 8 pos vs. 1 neg.
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1FLT3mrdneg$t1_MRD_MRGM_positive1_negative0, data=t1FLT3mrdneg)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1FLT3mrdneg,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1FLT3mrdneg$t1_MRD_MRGM_positive1_negative0, data=t1FLT3mrdneg)
coxph(Surv(RFS_years, RFS_status) ~ t1FLT3mrdneg$t1_MRD_MRGM_positive1_negative0, data=t1FLT3mrdneg) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1FLT3mrdneg -> t1 FLT3 MRD- MRGM pos vs. neg -> 8 pos vs. 1 neg.
```{r}
ci.all<-cuminc(ftime=t1FLT3mrdneg$RFS_years,fstatus=t1FLT3mrdneg$CIR_event,group=t1FLT3mrdneg$t1_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1FLT3mrdneg$RFS_years, t1FLT3mrdneg$CIR_event == 1, t1FLT3mrdneg$t1_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t2FLT3mrdpos -> t2 FLT3 MRD+ MRGM pos vs. neg -> 5 pts, no events
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2FLT3mrdpos$t2_MRD_MRGM_positive1_negative0, data=t2FLT3mrdpos)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2FLT3mrdpos,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2FLT3mrdpos$t2_MRD_MRGM_positive1_negative0, data=t2FLT3mrdpos)
coxph(Surv(OS_years, OS_status) ~ t2FLT3mrdpos$t2_MRD_MRGM_positive1_negative0, data=t2FLT3mrdpos) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2FLT3mrdpos -> t2 FLT3 MRD+ MRGM pos vs. neg -> 5 pts, no events in positive pts.
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2FLT3mrdpos$t2_MRD_MRGM_positive1_negative0, data=t2FLT3mrdpos)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2FLT3mrdpos,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2FLT3mrdpos$t2_MRD_MRGM_positive1_negative0, data=t2FLT3mrdpos)
coxph(Surv(RFS_years, RFS_status) ~ t2FLT3mrdpos$t2_MRD_MRGM_positive1_negative0, data=t2FLT3mrdpos) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2FLT3mrdpos -> t2 FLT3 MRD+ MRGM pos vs. neg -> 5 pts., no events in positive pts.
```{r}
ci.all<-cuminc(ftime=t2FLT3mrdpos$RFS_years,fstatus=t2FLT3mrdpos$CIR_event,group=t2FLT3mrdpos$t2_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2FLT3mrdpos$RFS_years, t2FLT3mrdpos$CIR_event == 1, t2FLT3mrdpos$t2_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t2FLT3mrdneg -> t2 FLT3 MRD- MRGM pos vs. neg -> 5 neg. vs 2 pos.
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2FLT3mrdneg$t2_MRD_MRGM_positive1_negative0, data=t2FLT3mrdneg)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2FLT3mrdneg,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2FLT3mrdneg$t2_MRD_MRGM_positive1_negative0, data=t2FLT3mrdneg)
coxph(Surv(OS_years, OS_status) ~ t2FLT3mrdneg$t2_MRD_MRGM_positive1_negative0, data=t2FLT3mrdneg) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2FLT3mrdneg -> t2 FLT3 MRD- MRGM pos vs. neg -> 5 neg. vs 2 pos.
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2FLT3mrdneg$t2_MRD_MRGM_positive1_negative0, data=t2FLT3mrdneg)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2FLT3mrdneg,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2FLT3mrdneg$t2_MRD_MRGM_positive1_negative0, data=t2FLT3mrdneg)
coxph(Surv(RFS_years, RFS_status) ~ t2FLT3mrdneg$t2_MRD_MRGM_positive1_negative0, data=t2FLT3mrdneg) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2FLT3mrdneg -> t2 FLT3 MRD+ MRGM pos vs. neg -> 5 neg. vs 2 pos.
```{r}
ci.all<-cuminc(ftime=t2FLT3mrdneg$RFS_years,fstatus=t2FLT3mrdneg$CIR_event,group=t2FLT3mrdneg$t2_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2FLT3mrdneg$RFS_years, t2FLT3mrdneg$CIR_event == 1, t2FLT3mrdneg$t2_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t1NPM1mrdpos -> t1 NPM1 MRD+ MRGM pos vs. neg -> only 2 Pts.!
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1NPM1mrdpos$t1_MRD_MRGM_positive1_negative0, data=t1NPM1mrdpos)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1NPM1mrdpos,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1NPM1mrdpos$t1_MRD_MRGM_positive1_negative0, data=t1NPM1mrdpos)
coxph(Surv(OS_years, OS_status) ~ t1NPM1mrdpos$t1_MRD_MRGM_positive1_negative0, data=t1NPM1mrdpos) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1NPM1mrdpos -> t1 NPM1 MRD+ MRGM pos vs. neg -> only 2 Pts.!
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1NPM1mrdpos$t1_MRD_MRGM_positive1_negative0, data=t1NPM1mrdpos)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1NPM1mrdpos,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1NPM1mrdpos$t1_MRD_MRGM_positive1_negative0, data=t1NPM1mrdpos)
coxph(Surv(RFS_years, RFS_status) ~ t1NPM1mrdpos$t1_MRD_MRGM_positive1_negative0, data=t1NPM1mrdpos) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1NPM1mrdpos -> t1 NPM1 MRD+ MRGM pos vs. neg -> only 2 Pts.!
```{r}
ci.all<-cuminc(ftime=t1NPM1mrdpos$RFS_years,fstatus=t1NPM1mrdpos$CIR_event,group=t1NPM1mrdpos$t1_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1NPM1mrdpos$RFS_years, t1NPM1mrdpos$CIR_event == 1, t1NPM1mrdpos$t1_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t1NPM1mrdneg -> t1 NPM1 MRD- MRGM pos vs. neg 
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1NPM1mrdneg$t1_MRD_MRGM_positive1_negative0, data=t1NPM1mrdneg)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1NPM1mrdneg,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1NPM1mrdneg$t1_MRD_MRGM_positive1_negative0, data=t1NPM1mrdneg)
coxph(Surv(OS_years, OS_status) ~ t1NPM1mrdneg$t1_MRD_MRGM_positive1_negative0, data=t1NPM1mrdneg) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1NPM1mrdneg -> t1 NPM1 MRD- MRGM pos vs. neg 
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1NPM1mrdneg$t1_MRD_MRGM_positive1_negative0, data=t1NPM1mrdneg)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1NPM1mrdneg,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1NPM1mrdneg$t1_MRD_MRGM_positive1_negative0, data=t1NPM1mrdneg)
coxph(Surv(RFS_years, RFS_status) ~ t1NPM1mrdneg$t1_MRD_MRGM_positive1_negative0, data=t1NPM1mrdneg) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1NPM1mrdneg -> t1 NPM1 MRD- MRGM pos vs. neg 
```{r}
ci.all<-cuminc(ftime=t1NPM1mrdneg$RFS_years,fstatus=t1NPM1mrdneg$CIR_event,group=t1NPM1mrdneg$t1_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1NPM1mrdneg$RFS_years, t1NPM1mrdneg$CIR_event == 1, t1NPM1mrdneg$t1_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t2NPM1mrdpos -> t2 NPM1 MRD+ MRGM pos vs. neg -> only 1 Pt.!
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2NPM1mrdpos$t2_MRD_MRGM_positive1_negative0, data=t2NPM1mrdpos)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2NPM1mrdpos,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2NPM1mrdpos$t2_MRD_MRGM_positive1_negative0, data=t2NPM1mrdpos)
coxph(Surv(OS_years, OS_status) ~ t2NPM1mrdpos$t2_MRD_MRGM_positive1_negative0, data=t2NPM1mrdpos) %>% 
  tbl_regression(exp = TRUE)
```


OS t2NPM1mrdneg -> t2 NPM1 MRD- MRGM pos vs. neg -> 7 neg. vs. 1 pos. without events
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2NPM1mrdneg$t2_MRD_MRGM_positive1_negative0, data=t2NPM1mrdneg)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2NPM1mrdneg,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2NPM1mrdneg$t2_MRD_MRGM_positive1_negative0, data=t2NPM1mrdneg)
coxph(Surv(OS_years, OS_status) ~ t2NPM1mrdneg$t2_MRD_MRGM_positive1_negative0, data=t2NPM1mrdneg) %>% 
  tbl_regression(exp = TRUE)
```

Co-Mutations
Prognostic Value of Comutations in cohort:


OS t1cohort -> Co-Mutations pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohort$t1_MRD_Comutations_positive1_negative0, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohort$t1_MRD_Comutations_positive1_negative0, data=t1cohort)
coxph(Surv(OS_years, OS_status) ~ t1cohort$t1_MRD_Comutations_positive1_negative0, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort -> Co-Mutations pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_Comutations_positive1_negative0, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_Comutations_positive1_negative0, data=t1cohort)
coxph(Surv(RFS_years, RFS_status) ~ t1cohort$t1_MRD_Comutations_positive1_negative0, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort -> Co-Mutations pos vs. neg.
```{r}
ci.all<-cuminc(ftime=t1cohort$RFS_years,fstatus=t1cohort$CIR_event,group=t1cohort$t1_MRD_Comutations_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohort$RFS_years, t1cohort$CIR_event == 1, t1cohort$t1_MRD_Comutations_positive1_negative0)
summary(fine_gray_test)

```



OS t1cohort -> Co-Mutations without DTA-Mutations pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohort$t1_MRD_Comutations_noDTA, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohort$t1_MRD_Comutations_noDTA, data=t1cohort)
coxph(Surv(OS_years, OS_status) ~ t1cohort$t1_MRD_Comutations_noDTA, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort -> Co-Mutations without DTA-Mutations pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_Comutations_noDTA, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_Comutations_noDTA, data=t1cohort)
coxph(Surv(RFS_years, RFS_status) ~ t1cohort$t1_MRD_Comutations_noDTA, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort -> Co-Mutations without DTA-Mutations pos vs. neg.
```{r}
ci.all<-cuminc(ftime=t1cohort$RFS_years,fstatus=t1cohort$CIR_event,group=t1cohort$t1_MRD_Comutations_noDTA)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohort$RFS_years, t1cohort$CIR_event == 1, t1cohort$t1_MRD_Comutations_noDTA)
summary(fine_gray_test)

```

OS t2cohort -> Co-Mutations pos vs. neg.
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohort$t2_MRD_Comutations_positive1_negative0, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohort$t2_MRD_Comutations_positive1_negative0, data=t2cohort)
coxph(Surv(OS_years, OS_status) ~ t2cohort$t2_MRD_Comutations_positive1_negative0, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort -> Co-Mutations pos vs. neg.
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_Comutations_positive1_negative0, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_Comutations_positive1_negative0, data=t2cohort)
coxph(Surv(RFS_years, RFS_status) ~ t2cohort$t2_MRD_Comutations_positive1_negative0, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort -> Co-Mutations pos vs. neg.
```{r}
ci.all<-cuminc(ftime=t2cohort$RFS_years,fstatus=t2cohort$CIR_event,group=t2cohort$t2_MRD_Comutations_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohort$RFS_years, t2cohort$CIR_event == 1, t2cohort$t2_MRD_Comutations_positive1_negative0)
summary(fine_gray_test)

```

OS t2cohort -> Co-Mutations without DTA-Mutations pos vs. neg. -> ONLY 3 positive Pts!
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohort$t2_MRD_Comutations_noDTA, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohort$t2_MRD_Comutations_noDTA, data=t2cohort)
coxph(Surv(OS_years, OS_status) ~ t2cohort$t2_MRD_Comutations_noDTA, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort -> Co-Mutations without DTA-Mutations pos vs. neg.
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_Comutations_noDTA, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_Comutations_noDTA, data=t2cohort)
coxph(Surv(RFS_years, RFS_status) ~ t2cohort$t2_MRD_Comutations_noDTA, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort -> Co-Mutations without DTA-Mutations pos vs. neg.
```{r}
ci.all<-cuminc(ftime=t2cohort$RFS_years,fstatus=t2cohort$CIR_event,group=t2cohort$t2_MRD_Comutations_noDTA)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohort$RFS_years, t2cohort$CIR_event == 1, t2cohort$t2_MRD_Comutations_noDTA)
summary(fine_gray_test)

```


OS t1mpositiv -> t1, MRG MRD+, Co-Mutations MRD pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1mpositiv$t1_MRD_Comutations_positive1_negative0, data=t1mpositiv)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1mpositiv,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1mpositiv$t1_MRD_Comutations_positive1_negative0, data=t1mpositiv)
coxph(Surv(OS_years, OS_status) ~ t1mpositiv$t1_MRD_Comutations_positive1_negative0, data=t1mpositiv) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1mpositiv -> t1, MRG MRD+, Co-Mutations MRD pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1mpositiv$t1_MRD_Comutations_positive1_negative0, data=t1mpositiv)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1mpositiv,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1mpositiv$t1_MRD_Comutations_positive1_negative0, data=t1mpositiv)
coxph(Surv(RFS_years, RFS_status) ~ t1mpositiv$t1_MRD_Comutations_positive1_negative0, data=t1mpositiv) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1mpositiv -> t1, MRG MRD+, Co-Mutations MRD pos vs. neg.
```{r}
ci.all<-cuminc(ftime=t1mpositiv$RFS_years,fstatus=t1mpositiv$CIR_event,group=t1mpositiv$t1_MRD_Comutations_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1mpositiv$RFS_years, t1mpositiv$CIR_event == 1, t1mpositiv$t1_MRD_Comutations_positive1_negative0)
summary(fine_gray_test)

```

OS t1mnegativ -> t1, MRG MRD-, Co-Mutations MRD pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1mnegativ$t1_MRD_Comutations_positive1_negative0, data=t1mnegativ)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1mnegativ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1mnegativ$t1_MRD_Comutations_positive1_negative0, data=t1mnegativ)
coxph(Surv(OS_years, OS_status) ~ t1mnegativ$t1_MRD_Comutations_positive1_negative0, data=t1mnegativ) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1mnegativ -> t1, MRG MRD-, Co-Mutations MRD pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1mnegativ$t1_MRD_Comutations_positive1_negative0, data=t1mnegativ)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1mnegativ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1mnegativ$t1_MRD_Comutations_positive1_negative0, data=t1mnegativ)
coxph(Surv(RFS_years, RFS_status) ~ t1mnegativ$t1_MRD_Comutations_positive1_negative0, data=t1mnegativ) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1mnegativ -> t1, MRG MRD-, Co-Mutations MRD pos vs. neg.
```{r}
ci.all<-cuminc(ftime=t1mnegativ$RFS_years,fstatus=t1mnegativ$CIR_event,group=t1mnegativ$t1_MRD_Comutations_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1mnegativ$RFS_years, t1mnegativ$CIR_event == 1, t1mnegativ$t1_MRD_Comutations_positive1_negative0)
summary(fine_gray_test)

```


OS t2mpositiv -> t2, MRG MRD+, Co-Mutations MRD pos vs. neg.
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2mpositiv$t2_MRD_Comutations_positive1_negative0, data=t2mpositiv)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2mpositiv,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2mpositiv$t2_MRD_Comutations_positive1_negative0, data=t2mpositiv)
coxph(Surv(OS_years, OS_status) ~ t2mpositiv$t2_MRD_Comutations_positive1_negative0, data=t2mpositiv) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2mpositiv -> t2, MRG MRD+, Co-Mutations MRD pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t2mpositiv$t2_MRD_Comutations_positive1_negative0, data=t2mpositiv)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2mpositiv,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2mpositiv$t2_MRD_Comutations_positive1_negative0, data=t2mpositiv)
coxph(Surv(RFS_years, RFS_status) ~ t2mpositiv$t2_MRD_Comutations_positive1_negative0, data=t2mpositiv) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2mpositiv -> t2, MRG MRD+, Co-Mutations MRD pos vs. neg.
```{r}
ci.all<-cuminc(ftime=t2mpositiv$RFS_years,fstatus=t2mpositiv$CIR_event,group=t2mpositiv$t2_MRD_Comutations_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2mpositiv$RFS_years, t2mpositiv$CIR_event == 1, t2mpositiv$t1_MRD_Comutations_positive1_negative0)
summary(fine_gray_test)

```

OS t2mnegativ -> t2, MRG MRD-, Co-Mutations MRD pos vs. neg.
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2mnegativ$t2_MRD_Comutations_positive1_negative0, data=t2mnegativ)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2mnegativ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2mnegativ$t2_MRD_Comutations_positive1_negative0, data=t2mnegativ)
coxph(Surv(OS_years, OS_status) ~ t2mnegativ$t2_MRD_Comutations_positive1_negative0, data=t2mnegativ) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2mnegativ -> t2, MRG MRD-, Co-Mutations MRD pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t2mnegativ$t2_MRD_Comutations_positive1_negative0, data=t2mnegativ)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2mnegativ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2mnegativ$t2_MRD_Comutations_positive1_negative0, data=t2mnegativ)
coxph(Surv(RFS_years, RFS_status) ~ t2mnegativ$t2_MRD_Comutations_positive1_negative0, data=t2mnegativ) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2mnegativ -> t2, MRG MRD-, Co-Mutations MRD pos vs. neg.
```{r}
ci.all<-cuminc(ftime=t2mnegativ$RFS_years,fstatus=t2mnegativ$CIR_event,group=t2mnegativ$t2_MRD_Comutations_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2mnegativ$RFS_years, t2mnegativ$CIR_event == 1, t2mnegativ$t1_MRD_Comutations_positive1_negative0)
summary(fine_gray_test)

```



OS t1compositiv -> t1, Comutations MRD+, MRGM MRD pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1compositiv$t1_MRD_MRGM_positive1_negative0, data=t1compositiv)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1compositiv,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1compositiv$t1_MRD_MRGM_positive1_negative0, data=t1compositiv)
coxph(Surv(OS_years, OS_status) ~ t1compositiv$t1_MRD_MRGM_positive1_negative0, data=t1compositiv) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1compositiv -> t1, Comutations MRD+, MRGM MRD pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1compositiv$t1_MRD_MRGM_positive1_negative0, data=t1compositiv)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1compositiv,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1compositiv$t1_MRD_MRGM_positive1_negative0, data=t1compositiv)
coxph(Surv(RFS_years, RFS_status) ~ t1compositiv$t1_MRD_MRGM_positive1_negative0, data=t1compositiv) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1compositiv -> t1, Comutations MRD+, MRGM MRD pos vs. neg.
```{r}
ci.all<-cuminc(ftime=t1compositiv$RFS_years,fstatus=t1compositiv$CIR_event,group=t1compositiv$t1_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1compositiv$RFS_years, t1compositiv$CIR_event == 1, t1compositiv$t1_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```

OS t1comnegativ -> t1, Comutations MRD-, MRGM MRD pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1comnegativ$t1_MRD_MRGM_positive1_negative0, data=t1comnegativ)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1comnegativ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1comnegativ$t1_MRD_MRGM_positive1_negative0, data=t1comnegativ)
coxph(Surv(OS_years, OS_status) ~ t1comnegativ$t1_MRD_MRGM_positive1_negative0, data=t1comnegativ) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1comnegativ -> t1, Comutations MRD-, MRGM MRD pos vs. neg.
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1comnegativ$t1_MRD_MRGM_positive1_negative0, data=t1comnegativ)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1comnegativ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1comnegativ$t1_MRD_MRGM_positive1_negative0, data=t1comnegativ)
coxph(Surv(RFS_years, RFS_status) ~ t1comnegativ$t1_MRD_MRGM_positive1_negative0, data=t1comnegativ) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1comnegativ -> t1, Comutations MRD-, MRGM MRD pos vs. neg.
```{r}
ci.all<-cuminc(ftime=t1comnegativ$RFS_years,fstatus=t1comnegativ$CIR_event,group=t1comnegativ$t1_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1comnegativ$RFS_years, t1comnegativ$CIR_event == 1, t1comnegativ$t1_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```

OS t2compositiv -> t2, Comutations MRD+, MRGM MRD pos vs. neg.
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2compositiv$t2_MRD_MRGM_positive1_negative0, data=t2compositiv)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2compositiv,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2compositiv$t2_MRD_MRGM_positive1_negative0, data=t2compositiv)
coxph(Surv(OS_years, OS_status) ~ t2compositiv$t2_MRD_MRGM_positive1_negative0, data=t2compositiv) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2compositiv -> t2, Comutations MRD+, MRGM MRD pos vs. neg.
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2compositiv$t2_MRD_MRGM_positive1_negative0, data=t2compositiv)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2compositiv,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2compositiv$t2_MRD_MRGM_positive1_negative0, data=t2compositiv)
coxph(Surv(RFS_years, RFS_status) ~ t2compositiv$t2_MRD_MRGM_positive1_negative0, data=t2compositiv) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2compositiv -> t2, Comutations MRD+, MRGM MRD pos vs. neg.
```{r}
ci.all<-cuminc(ftime=t2compositiv$RFS_years,fstatus=t2compositiv$CIR_event,group=t2compositiv$t2_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2compositiv$RFS_years, t2compositiv$CIR_event == 1, t2compositiv$t2_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```

OS t2comnegativ -> t2, Comutations MRD-, MRGM MRD pos vs. neg.
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2comnegativ$t2_MRD_MRGM_positive1_negative0, data=t2comnegativ)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2comnegativ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2comnegativ$t2_MRD_MRGM_positive1_negative0, data=t2comnegativ)
coxph(Surv(OS_years, OS_status) ~ t2comnegativ$t2_MRD_MRGM_positive1_negative0, data=t2comnegativ) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2comnegativ -> t2, Comutations MRD-, MRGM MRD pos vs. neg.
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2comnegativ$t2_MRD_MRGM_positive1_negative0, data=t2comnegativ)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2comnegativ,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2comnegativ$t2_MRD_MRGM_positive1_negative0, data=t2comnegativ)
coxph(Surv(RFS_years, RFS_status) ~ t2comnegativ$t2_MRD_MRGM_positive1_negative0, data=t2comnegativ) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2comnegativ -> t2, Comutations MRD-, MRGM MRD pos vs. neg.
```{r}
ci.all<-cuminc(ftime=t2comnegativ$RFS_years,fstatus=t2comnegativ$CIR_event,group=t2comnegativ$t2_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2comnegativ$RFS_years, t2comnegativ$CIR_event == 1, t2comnegativ$t2_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t1cohortnonpm1 -> t1cohort without NPM1-mut. Patients
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohortnonpm1$t1_MRD_MRGM_positive1_negative0, data=t1cohortnonpm1)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohortnonpm1,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohortnonpm1$t1_MRD_MRGM_positive1_negative0, data=t1cohortnonpm1)
coxph(Surv(OS_years, OS_status) ~ t1cohortnonpm1$t1_MRD_MRGM_positive1_negative0, data=t1cohortnonpm1) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohortnonpm1 -> t1cohort without NPM1mut Pts.
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohortnonpm1$t1_MRD_MRGM_positive1_negative0, data=t1cohortnonpm1)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohortnonpm1,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohortnonpm1$t1_MRD_MRGM_positive1_negative0, data=t1cohortnonpm1)
coxph(Surv(RFS_years, RFS_status) ~ t1cohortnonpm1$t1_MRD_MRGM_positive1_negative0, data=t1cohortnonpm1) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohortnonpm1 -> t1cohort without NPM1mut Pts
```{r}
ci.all<-cuminc(ftime=t1cohortnonpm1$RFS_years,fstatus=t1cohortnonpm1$CIR_event,group=t1cohortnonpm1$t1_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohortnonpm1$RFS_years, t1cohortnonpm1$CIR_event == 1, t1cohortnonpm1$t1_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t2cohortnonpm1 -> t2cohort without NPM1-mut. Patients -> significance! 
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohortnonpm1$t2_MRD_MRGM_positive1_negative0, data=t2cohortnonpm1)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohortnonpm1,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohortnonpm1$t2_MRD_MRGM_positive1_negative0, data=t2cohortnonpm1)
coxph(Surv(OS_years, OS_status) ~ t2cohortnonpm1$t2_MRD_MRGM_positive1_negative0, data=t2cohortnonpm1) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohortnonpm1 -> t2cohort without NPM1mut Pts.
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohortnonpm1$t2_MRD_MRGM_positive1_negative0, data=t2cohortnonpm1)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohortnonpm1,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohortnonpm1$t2_MRD_MRGM_positive1_negative0, data=t2cohortnonpm1)
coxph(Surv(RFS_years, RFS_status) ~ t2cohortnonpm1$t2_MRD_MRGM_positive1_negative0, data=t2cohortnonpm1) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohortnonpm1 -> t2cohort without NPM1mut Pts
```{r}
ci.all<-cuminc(ftime=t2cohortnonpm1$RFS_years,fstatus=t2cohortnonpm1$CIR_event,group=t2cohortnonpm1$t2_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohortnonpm1$RFS_years, t2cohortnonpm1$CIR_event == 1, t2cohortnonpm1$t2_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS overlapt1posnonpm1 -> overlap t1t2 t1MRG-MRD+ without NPM1-mut. Patients -> Conversion as prognostic marker?
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~overlapt1posnonpm1$t2_MRD_MRGM_positive1_negative0, data=overlapt1posnonpm1)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = overlapt1posnonpm1,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~overlapt1posnonpm1$t2_MRD_MRGM_positive1_negative0, data=overlapt1posnonpm1)
coxph(Surv(OS_years, OS_status) ~ overlapt1posnonpm1$t2_MRD_MRGM_positive1_negative0, data=overlapt1posnonpm1) %>% 
  tbl_regression(exp = TRUE)
```
RFS overlapt1posnonpm1 -> overlap t1t2 t1MRG-MRD+ without NPM1-mut. Patients -> Conversion as prognostic marker?
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~overlapt1posnonpm1$t2_MRD_MRGM_positive1_negative0, data=overlapt1posnonpm1)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = overlapt1posnonpm1,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~overlapt1posnonpm1$t2_MRD_MRGM_positive1_negative0, data=overlapt1posnonpm1)
coxph(Surv(RFS_years, RFS_status) ~ overlapt1posnonpm1$t2_MRD_MRGM_positive1_negative0, data=overlapt1posnonpm1) %>% 
  tbl_regression(exp = TRUE)
```
CIR overlapt1posnonpm1 -> overlap t1t2 t1MRG-MRD+ without NPM1-mut. Patients -> Conversion as prognostic marker?
```{r}
ci.all<-cuminc(ftime=overlapt1posnonpm1$RFS_years,fstatus=overlapt1posnonpm1$CIR_event,group=overlapt1posnonpm1$t2_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(overlapt1posnonpm1$RFS_years, overlapt1posnonpm1$CIR_event == 1, overlapt1posnonpm1$t2_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t1cohort - Tx Only (t1txonly) - MRD MRGM
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1txonly$t1_MRD_MRGM_positive1_negative0, data=t1txonly)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1txonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1txonly$t1_MRD_MRGM_positive1_negative0, data=t1txonly)
coxph(Surv(OS_years, OS_status) ~ t1txonly$t1_MRD_MRGM_positive1_negative0, data=t1txonly) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort - Tx Only (t1txonly) - MRD MRGM
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1txonly$t1_MRD_MRGM_positive1_negative0, data=t1txonly)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1txonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1txonly$t1_MRD_MRGM_positive1_negative0, data=t1txonly)
coxph(Surv(RFS_years, RFS_status) ~ t1txonly$t1_MRD_MRGM_positive1_negative0, data=t1txonly) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort - Tx Only (t1txonly) - MRD MRGM
```{r}
ci.all<-cuminc(ftime=t1txonly$RFS_years,fstatus=t1txonly$CIR_event,group=t1txonly$t1_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1txonly$RFS_years, t1txonly$CIR_event == 1, t1txonly$t1_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```

OS t2cohort - Tx only (t2txonly) - MRD MRGM
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2txonly$t2_MRD_MRGM_positive1_negative0, data=t2txonly)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2txonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2txonly$t2_MRD_MRGM_positive1_negative0, data=t2txonly)
coxph(Surv(OS_years, OS_status) ~ t2txonly$t2_MRD_MRGM_positive1_negative0, data=t2txonly) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort - Tx only (t2txonly) - MRD MRGM
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2txonly$t2_MRD_MRGM_positive1_negative0, data=t2txonly)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2txonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2txonly$t2_MRD_MRGM_positive1_negative0, data=t2txonly)
coxph(Surv(RFS_years, RFS_status) ~ t2txonly$t2_MRD_MRGM_positive1_negative0, data=t2txonly) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort - Tx only (t2txonly) - MRD MRGM
```{r}
ci.all<-cuminc(ftime=t2txonly$RFS_years,fstatus=t2txonly$CIR_event,group=t2txonly$t2_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2txonly$RFS_years, t2txonly$CIR_event == 1, t2txonly$t2_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t1cohort - chemo Only (t1chemoonly) - MRD MRGM
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1chemoonly$t1_MRD_MRGM_positive1_negative0, data=t1chemoonly)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1chemoonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1chemoonly$t1_MRD_MRGM_positive1_negative0, data=t1chemoonly)
coxph(Surv(OS_years, OS_status) ~ t1chemoonly$t1_MRD_MRGM_positive1_negative0, data=t1chemoonly) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort - chemo Only (t1chemoonly) - MRD MRGM
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1chemoonly$t1_MRD_MRGM_positive1_negative0, data=t1chemoonly)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1chemoonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1chemoonly$t1_MRD_MRGM_positive1_negative0, data=t1chemoonly)
coxph(Surv(RFS_years, RFS_status) ~ t1chemoonly$t1_MRD_MRGM_positive1_negative0, data=t1chemoonly) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort - chemo Only (t1chemoonly) - MRD MRGM
```{r}
ci.all<-cuminc(ftime=t1chemoonly$RFS_years,fstatus=t1chemoonly$CIR_event,group=t1chemoonly$t1_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1chemoonly$RFS_years, t1chemoonly$CIR_event == 1, t1chemoonly$t1_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```

OS t2cohort - Chemo only (t2chemoonly) - MRD MRGM - 7 pts. only
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2chemoonly$t2_MRD_MRGM_positive1_negative0, data=t2chemoonly)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2chemoonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2chemoonly$t1_MRD_MRGM_positive1_negative0, data=t2chemoonly)
coxph(Surv(OS_years, OS_status) ~ t2chemoonly$t1_MRD_MRGM_positive1_negative0, data=t2chemoonly) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort - Chemo only (t2chemoonly) - MRD MRGM - 7 pts. only
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2chemoonly$t2_MRD_MRGM_positive1_negative0, data=t2chemoonly)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2chemoonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2chemoonly$t2_MRD_MRGM_positive1_negative0, data=t2chemoonly)
coxph(Surv(RFS_years, RFS_status) ~ t2chemoonly$t2_MRD_MRGM_positive1_negative0, data=t2chemoonly) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort - Chemo only (t2chemoonly) - MRD MRGM - 7 pts. only
```{r}
ci.all<-cuminc(ftime=t2chemoonly$RFS_years,fstatus=t2chemoonly$CIR_event,group=t2chemoonly$t2_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2chemoonly$RFS_years, t2chemoonly$CIR_event == 1, t2chemoonly$t2_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t1cohort - Tx Only (t1txonly), MRD MRGM without ASXL1 
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1txonly$t1_MRD_MRGM_noASXL1, data=t1txonly)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1txonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1txonly$t1_MRD_MRGM_noASXL1, data=t1txonly)
coxph(Surv(OS_years, OS_status) ~ t1txonly$t1_MRD_MRGM_noASXL1, data=t1txonly) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort - Tx Only (t1txonly), MRD MRGM without ASXL1 
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1txonly$t1_MRD_MRGM_noASXL1, data=t1txonly)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1txonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1txonly$t1_MRD_MRGM_noASXL1, data=t1txonly)
coxph(Surv(RFS_years, RFS_status) ~ t1txonly$t1_MRD_MRGM_noASXL1, data=t1txonly) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort - Tx Only (t1txonly), MRD MRGM without ASXL1 
```{r}
ci.all<-cuminc(ftime=t1txonly$RFS_years,fstatus=t1txonly$CIR_event,group=t1txonly$t1_MRD_MRGM_noASXL1)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1txonly$RFS_years, t1txonly$CIR_event == 1, t1txonly$t1_MRD_MRGM_noASXL1)
summary(fine_gray_test)

```

OS t2cohort - Tx only (t2txonly), MRD MRGM without ASXL1 (- 59 neg vs. 8 pos)
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2txonly$t2_MRD_MRGM_noASXL1, data=t2txonly)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2txonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2txonly$t2_MRD_MRGM_noASXL1, data=t2txonly)
coxph(Surv(OS_years, OS_status) ~ t2txonly$t2_MRD_MRGM_noASXL1, data=t2txonly) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort - Tx only (t2txonly), MRD MRGM without ASXL1
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2txonly$t2_MRD_MRGM_noASXL1, data=t2txonly)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2txonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2txonly$t2_MRD_MRGM_noASXL1, data=t2txonly)
coxph(Surv(RFS_years, RFS_status) ~ t2txonly$t2_MRD_MRGM_noASXL1, data=t2txonly) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort - Tx only (t2txonly), MRD MRGM without ASXL1
```{r}
ci.all<-cuminc(ftime=t2txonly$RFS_years,fstatus=t2txonly$CIR_event,group=t2txonly$t2_MRD_MRGM_noASXL1)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2txonly$RFS_years, t2txonly$CIR_event == 1, t2txonly$t2_MRD_MRGM_noASXL1)
summary(fine_gray_test)

```


OS t1cohort - chemo Only (t1chemoonly) - MRD MRGM without ASXL1
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1chemoonly$t1_MRD_MRGM_noASXL1, data=t1chemoonly)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1chemoonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1chemoonly$t1_MRD_MRGM_noASXL1, data=t1chemoonly)
coxph(Surv(OS_years, OS_status) ~ t1chemoonly$t1_MRD_MRGM_noASXL1, data=t1chemoonly) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort - chemo Only (t1chemoonly) - MRD MRGM without ASXL1
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1chemoonly$t1_MRD_MRGM_noASXL1, data=t1chemoonly)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1chemoonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1chemoonly$t1_MRD_MRGM_noASXL1, data=t1chemoonly)
coxph(Surv(RFS_years, RFS_status) ~ t1chemoonly$t1_MRD_MRGM_noASXL1, data=t1chemoonly) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort - chemo Only (t1chemoonly) - MRD MRGM without ASXL1
```{r}
ci.all<-cuminc(ftime=t1chemoonly$RFS_years,fstatus=t1chemoonly$CIR_event,group=t1chemoonly$t1_MRD_MRGM_noASXL1)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1chemoonly$RFS_years, t1chemoonly$CIR_event == 1, t1chemoonly$t1_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t1cohort, PB only (t1pbonly) - MRD MRG pos vs neg
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1pbonly$t1_MRD_MRGM_positive1_negative0, data=t1pbonly)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1pbonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1pbonly$t1_MRD_MRGM_positive1_negative0, data=t1pbonly)
coxph(Surv(OS_years, OS_status) ~ t1pbonly$t1_MRD_MRGM_positive1_negative0, data=t1pbonly) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort, PB only (t1pbonly) - MRD MRG pos vs neg
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1pbonly$t1_MRD_MRGM_positive1_negative0, data=t1pbonly)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1pbonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1pbonly$t1_MRD_MRGM_positive1_negative0, data=t1pbonly)
coxph(Surv(RFS_years, RFS_status) ~ t1pbonly$t1_MRD_MRGM_positive1_negative0, data=t1pbonly) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort, PB only (t1pbonly) - MRD MRG pos vs neg
```{r}
ci.all<-cuminc(ftime=t1pbonly$RFS_years,fstatus=t1pbonly$CIR_event,group=t1pbonly$t1_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1pbonly$RFS_years, t1pbonly$CIR_event == 1, t1pbonly$t1_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t1cohort, BM only (t1bmonly) - MRD MRG pos vs neg
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1bmonly$t1_MRD_MRGM_positive1_negative0, data=t1bmonly)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1bmonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1bmonly$t1_MRD_MRGM_positive1_negative0, data=t1bmonly)
coxph(Surv(OS_years, OS_status) ~ t1bmonly$t1_MRD_MRGM_positive1_negative0, data=t1bmonly) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort, BM only (t1bmonly) - MRD MRG pos vs neg
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1bmonly$t1_MRD_MRGM_positive1_negative0, data=t1bmonly)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1bmonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1bmonly$t1_MRD_MRGM_positive1_negative0, data=t1bmonly)
coxph(Surv(RFS_years, RFS_status) ~ t1bmonly$t1_MRD_MRGM_positive1_negative0, data=t1bmonly) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort, BM only (t1bmonly) - MRD MRG pos vs neg
```{r}
ci.all<-cuminc(ftime=t1bmonly$RFS_years,fstatus=t1bmonly$CIR_event,group=t1bmonly$t1_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1bmonly$RFS_years, t1bmonly$CIR_event == 1, t1bmonly$t1_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t2cohort - PB only (t2pbonly) - MRD MRG pos vs neg
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2pbonly$t2_MRD_MRGM_positive1_negative0, data=t2pbonly)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2pbonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2pbonly$t2_MRD_MRGM_positive1_negative0, data=t2pbonly)
coxph(Surv(OS_years, OS_status) ~ t2pbonly$t2_MRD_MRGM_positive1_negative0, data=t2pbonly) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort - PB only (t2pbonly) - MRD MRG pos vs neg
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2pbonly$t2_MRD_MRGM_positive1_negative0, data=t2pbonly)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2pbonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2pbonly$t2_MRD_MRGM_positive1_negative0, data=t2pbonly)
coxph(Surv(RFS_years, RFS_status) ~ t2pbonly$t2_MRD_MRGM_positive1_negative0, data=t2pbonly) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort - PB only (t2pbonly) - MRD MRG pos vs neg
```{r}
ci.all<-cuminc(ftime=t2pbonly$RFS_years,fstatus=t2pbonly$CIR_event,group=t2pbonly$t2_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2pbonly$RFS_years, t2pbonly$CIR_event == 1, t2pbonly$t2_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t2cohort - BM only (t2bmonly) - MRD MRG pos vs neg
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2bmonly$t2_MRD_MRGM_positive1_negative0, data=t2bmonly)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2bmonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2bmonly$t2_MRD_MRGM_positive1_negative0, data=t2bmonly)
coxph(Surv(OS_years, OS_status) ~ t2bmonly$t2_MRD_MRGM_positive1_negative0, data=t2bmonly) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort - BM only (t2bmonly) - MRD MRG pos vs neg
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2bmonly$t2_MRD_MRGM_positive1_negative0, data=t2bmonly)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2bmonly,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2bmonly$t2_MRD_MRGM_positive1_negative0, data=t2bmonly)
coxph(Surv(RFS_years, RFS_status) ~ t2bmonly$t2_MRD_MRGM_positive1_negative0, data=t2bmonly) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort - BM only (t2bmonly) - MRD MRG pos vs neg
```{r}
ci.all<-cuminc(ftime=t2bmonly$RFS_years,fstatus=t2bmonly$CIR_event,group=t2bmonly$t2_MRD_MRGM_positive1_negative0)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2bmonly$RFS_years, t2bmonly$CIR_event == 1, t2bmonly$t2_MRD_MRGM_positive1_negative0)
summary(fine_gray_test)

```


OS t1cohort, ASXL1 only - no events in MRD negative group
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohort$t1_MRD_ASXL1, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohort$t1_MRD_ASXL1, data=t1cohort)
coxph(Surv(OS_years, OS_status) ~ t1cohort$t1_MRD_ASXL1, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort, ASXL1 only
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_ASXL1, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_ASXL1, data=t1cohort)
coxph(Surv(RFS_years, RFS_status) ~ t1cohort$t1_MRD_ASXL1, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort, ASXL1 only
```{r}
ci.all<-cuminc(ftime=t1cohort$RFS_years,fstatus=t1cohort$CIR_event,group=t1cohort$t1_MRD_ASXL1)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohort$RFS_years, t1cohort$CIR_event == 1, t1cohort$t1_MRD_ASXL1)
summary(fine_gray_test)

```


OS t2cohort, ASXL1 only
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohort$t2_MRD_ASXL1, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohort$t2_MRD_ASXL1, data=t2cohort)
coxph(Surv(OS_years, OS_status) ~ t2cohort$t2_MRD_ASXL1, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort, ASXL1 only
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_ASXL1, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_ASXL1, data=t2cohort)
coxph(Surv(RFS_years, RFS_status) ~ t2cohort$t2_MRD_ASXL1, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort, ASXL1 only
```{r}
ci.all<-cuminc(ftime=t2cohort$RFS_years,fstatus=t2cohort$CIR_event,group=t2cohort$t2_MRD_ASXL1)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohort$RFS_years, t2cohort$CIR_event == 1, t2cohort$t2_MRD_ASXL1)
summary(fine_gray_test)

```


OS t1cohort, BCOR only
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohort$t1_MRD_BCOR, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohort$t1_MRD_BCOR, data=t1cohort)
coxph(Surv(OS_years, OS_status) ~ t1cohort$t1_MRD_BCOR, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort, BCOR only
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_BCOR, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_BCOR, data=t1cohort)
coxph(Surv(RFS_years, RFS_status) ~ t1cohort$t1_MRD_BCOR, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort, BCOR only
```{r}
ci.all<-cuminc(ftime=t1cohort$RFS_years,fstatus=t1cohort$CIR_event,group=t1cohort$t1_MRD_BCOR)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohort$RFS_years, t1cohort$CIR_event == 1, t1cohort$t1_MRD_BCOR)
summary(fine_gray_test)

```


OS t2cohort, BCOR only - 13 neg. vs 2 pos
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohort$t2_MRD_BCOR, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohort$t2_MRD_BCOR, data=t2cohort)
coxph(Surv(OS_years, OS_status) ~ t2cohort$t2_MRD_BCOR, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort, BCOR only
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_BCOR, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_BCOR, data=t2cohort)
coxph(Surv(RFS_years, RFS_status) ~ t2cohort$t2_MRD_BCOR, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort, BCOR only
```{r}
ci.all<-cuminc(ftime=t2cohort$RFS_years,fstatus=t2cohort$CIR_event,group=t2cohort$t2_MRD_BCOR)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohort$RFS_years, t2cohort$CIR_event == 1, t2cohort$t2_MRD_BCOR)
summary(fine_gray_test)

```


OS t1cohort, RUNX1 only - 0 events in MRD negative group
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohort$t1_MRD_RUNX1, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohort$t1_MRD_RUNX1, data=t1cohort)
coxph(Surv(OS_years, OS_status) ~ t1cohort$t1_MRD_RUNX1, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort, RUNX1 only
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_RUNX1, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_RUNX1, data=t1cohort)
coxph(Surv(RFS_years, RFS_status) ~ t1cohort$t1_MRD_RUNX1, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort, RUNX1 only
```{r}
ci.all<-cuminc(ftime=t1cohort$RFS_years,fstatus=t1cohort$CIR_event,group=t1cohort$t1_MRD_RUNX1)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohort$RFS_years, t1cohort$CIR_event == 1, t1cohort$t1_MRD_RUNX1)
summary(fine_gray_test)

```


OS t2cohort, RUNX1 only (24 neg vs 3 pos., 0 events in positive group)
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohort$t2_MRD_RUNX1, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohort$t2_MRD_RUNX1, data=t2cohort)
coxph(Surv(OS_years, OS_status) ~ t2cohort$t2_MRD_RUNX1, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort, RUNX1 only
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_RUNX1, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_RUNX1, data=t2cohort)
coxph(Surv(RFS_years, RFS_status) ~ t2cohort$t2_MRD_RUNX1, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort, RUNX1 only
```{r}
ci.all<-cuminc(ftime=t2cohort$RFS_years,fstatus=t2cohort$CIR_event,group=t2cohort$t2_MRD_RUNX1)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohort$RFS_years, t2cohort$CIR_event == 1, t2cohort$t2_MRD_RUNX1)
summary(fine_gray_test)

```


OS t1cohort, SRSF2 only - 19 pos vs. 6 neg.
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohort$t1_MRD_SRSF2, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohort$t1_MRD_SRSF2, data=t1cohort)
coxph(Surv(OS_years, OS_status) ~ t1cohort$t1_MRD_SRSF2, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort, SRSF2 only
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_SRSF2, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_SRSF2, data=t1cohort)
coxph(Surv(RFS_years, RFS_status) ~ t1cohort$t1_MRD_SRSF2, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort, SRSF2 only
```{r}
ci.all<-cuminc(ftime=t1cohort$RFS_years,fstatus=t1cohort$CIR_event,group=t1cohort$t1_MRD_SRSF2)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohort$RFS_years, t1cohort$CIR_event == 1, t1cohort$t1_MRD_SRSF2)
summary(fine_gray_test)

```


OS t2cohort, SRSF2 only (19 neg vs. 4 pos)
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohort$t2_MRD_SRSF2, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohort$t2_MRD_SRSF2, data=t2cohort)
coxph(Surv(OS_years, OS_status) ~ t2cohort$t2_MRD_SRSF2, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort, SRSF2 only 
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_SRSF2, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_SRSF2, data=t2cohort)
coxph(Surv(RFS_years, RFS_status) ~ t2cohort$t2_MRD_SRSF2, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort, SRSF2 only
```{r}
ci.all<-cuminc(ftime=t2cohort$RFS_years,fstatus=t2cohort$CIR_event,group=t2cohort$t2_MRD_SRSF2)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohort$RFS_years, t2cohort$CIR_event == 1, t2cohort$t2_MRD_SRSF2)
summary(fine_gray_test)

```



OS t1cohort, STAG2 only
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohort$t1_MRD_STAG2, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohort$t1_MRD_STAG2, data=t1cohort)
coxph(Surv(OS_years, OS_status) ~ t1cohort$t1_MRD_STAG2, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort, STAG2 only
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_STAG2, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohort$t1_MRD_STAG2, data=t1cohort)
coxph(Surv(RFS_years, RFS_status) ~ t1cohort$t1_MRD_STAG2, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort, STAG2 only
```{r}
ci.all<-cuminc(ftime=t1cohort$RFS_years,fstatus=t1cohort$CIR_event,group=t1cohort$t1_MRD_STAG2)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohort$RFS_years, t1cohort$CIR_event == 1, t1cohort$t1_MRD_STAG2)
summary(fine_gray_test)

```


OS t2cohort, STAG2 only - ERROR: 0 positive!
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohort$t2_MRD_STAG2, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohort$t2_MRD_STAG2, data=t2cohort)
coxph(Surv(OS_years, OS_status) ~ t2cohort$t2_MRD_STAG2, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort, STAG2 only
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_STAG2, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c("MRD negative", "MRD positive"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohort$t2_MRD_STAG2, data=t2cohort)
coxph(Surv(RFS_years, RFS_status) ~ t2cohort$t2_MRD_STAG2, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort, STAG2 only
```{r}
ci.all<-cuminc(ftime=t2cohort$RFS_years,fstatus=t2cohort$CIR_event,group=t2cohort$t2_MRD_STAG2)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c("MRD neg", "MRD pos"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohort$RFS_years, t2cohort$CIR_event == 1, t2cohort$t2_MRD_STAG2)
summary(fine_gray_test)

```


OS t1cohort, FC_gr1 Fold Change <100 vs >100 (2-log)
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohort$FC_gr1, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c(">2-log reduction", "<2-log reduction"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohort$FC_gr1, data=t1cohort)
coxph(Surv(OS_years, OS_status) ~ t1cohort$FC_gr1, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort, FC_gr1 Fold Change <100 vs >100 (2-log)
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohort$FC_gr1, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c(">2-log reduction", "<2-log reduction"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohort$FC_gr1, data=t1cohort)
coxph(Surv(RFS_years, RFS_status) ~ t1cohort$FC_gr1, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort, FC_gr1 Fold Change <100 vs >100 (2-log)
```{r}
ci.all<-cuminc(ftime=t1cohort$RFS_years,fstatus=t1cohort$CIR_event,group=t1cohort$FC_gr1)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c(">2-log reduction", "<2-log reduction"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohort$RFS_years, t1cohort$CIR_event == 1, t1cohort$FC_gr1)
summary(fine_gray_test)

```


OS t1cohort, FC_gr2 Fold Change <1000 vs >1000 (3-log)
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohort$FC_gr2, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c(">3-log reduction", "<3-log reduction"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohort$FC_gr2, data=t1cohort)
coxph(Surv(OS_years, OS_status) ~ t1cohort$FC_gr2, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort, FC_gr2 Fold Change <1000 vs >1000 (3-log)
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohort$FC_gr2, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c(">3-log reduction", "<3-log reduction"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohort$FC_gr2, data=t1cohort)
coxph(Surv(RFS_years, RFS_status) ~ t1cohort$FC_gr2, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort, FC_gr2 Fold Change <1000 vs >1000 (3-log)
```{r}
ci.all<-cuminc(ftime=t1cohort$RFS_years,fstatus=t1cohort$CIR_event,group=t1cohort$FC_gr2)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c(">3-log reduction", "<3-log reduction"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohort$RFS_years, t1cohort$CIR_event == 1, t1cohort$FC_gr2)
summary(fine_gray_test)

```


OS t1cohort, FC_gr3 Fold Change <10000 vs >10000 (4-log)
```{r}
fit_t1cohort<- survfit(Surv(OS_years, OS_status)~t1cohort$FC_gr3, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c(">4-log reduction", "<4-log reduction"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t1cohort$FC_gr3, data=t1cohort)
coxph(Surv(OS_years, OS_status) ~ t1cohort$FC_gr3, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t1cohort, FC_gr3 Fold Change <10000 vs >10000 (4-log)
```{r}
fit_t1cohort<- survfit(Surv(RFS_years, RFS_status)~t1cohort$FC_gr3, data=t1cohort)
ggsurv <- ggsurvplot(
  fit_t1cohort,                     # survfit object with calculated statistics.
  data = t1cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c(">4-log reduction", "<4-log reduction"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t1cohort$FC_gr3, data=t1cohort)
coxph(Surv(RFS_years, RFS_status) ~ t1cohort$FC_gr3, data=t1cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t1cohort, FC_gr3 Fold Change <10000 vs >10000 (4-log)
```{r}
ci.all<-cuminc(ftime=t1cohort$RFS_years,fstatus=t1cohort$CIR_event,group=t1cohort$FC_gr3)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c(">4-log reduction", "<4-log reduction"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t1cohort$RFS_years, t1cohort$CIR_event == 1, t1cohort$FC_gr3)
summary(fine_gray_test)

```


OS t2cohort,  FC_gr1_t2 Fold Change <100 vs >100 (2-log)
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohort$FC_gr1_t2, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c(">2-log reduction", "<2-log reduction"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohort$FC_gr1_t2, data=t2cohort)
coxph(Surv(OS_years, OS_status) ~ t2cohort$FC_gr1_t2, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort,  FC_gr1_t2 Fold Change <100 vs >100 (2-log)
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohort$FC_gr1_t2, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c(">2-log reduction", "<2-log reduction"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohort$FC_gr1_t2, data=t2cohort)
coxph(Surv(RFS_years, RFS_status) ~ t2cohort$FC_gr1_t2, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort,  FC_gr1_t2 Fold Change <100 vs >100 (2-log)
```{r}
ci.all<-cuminc(ftime=t2cohort$RFS_years,fstatus=t2cohort$CIR_event,group=t2cohort$FC_gr1_t2)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c(">2-log reduction", "<2-log reduction"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohort$RFS_years, t2cohort$CIR_event == 1, t2cohort$FC_gr1_t2)
summary(fine_gray_test)

```


OS t2cohort,  FC_gr2_t2 Fold Change <1000 vs >1000 (3-log)
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohort$FC_gr2_t2, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c(">3-log reduction", "<3-log reduction"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohort$FC_gr2_t2, data=t2cohort)
coxph(Surv(OS_years, OS_status) ~ t2cohort$FC_gr2_t2, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort,  FC_gr2_t2 Fold Change <1000 vs >1000 (3-log)
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohort$FC_gr2_t2, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c(">3-log reduction", "<3-log reduction"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohort$FC_gr2_t2, data=t2cohort)
coxph(Surv(RFS_years, RFS_status) ~ t2cohort$FC_gr2_t2, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort,  FC_gr2_t2 Fold Change <1000 vs >1000 (3-log)
```{r}
ci.all<-cuminc(ftime=t2cohort$RFS_years,fstatus=t2cohort$CIR_event,group=t2cohort$FC_gr2_t2)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c(">3-log reduction", "<3-log reduction"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohort$RFS_years, t2cohort$CIR_event == 1, t2cohort$FC_gr2_t2)
summary(fine_gray_test)

```


OS t2cohort,  FC_gr3_t2 Fold Change <10000 vs >10000 (4-log)
```{r}
fit_t2cohort<- survfit(Surv(OS_years, OS_status)~t2cohort$FC_gr3_t2, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c(">4-log reduction", "<4-log reduction"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(OS_years, OS_status)~t2cohort$FC_gr3_t2, data=t2cohort)
coxph(Surv(OS_years, OS_status) ~ t2cohort$FC_gr3_t2, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
RFS t2cohort,  FC_gr3_t2 Fold Change <10000 vs >10000 (4-log)
```{r}
fit_t2cohort<- survfit(Surv(RFS_years, RFS_status)~t2cohort$FC_gr3_t2, data=t2cohort)
ggsurv <- ggsurvplot(
  fit_t2cohort,                     # survfit object with calculated statistics.
  data = t2cohort,             # data used to fit survival curves.
  risk.table = TRUE, fontsize = 5,      # show risk table.
  pval = TRUE, # show p-value of log-rank test.
  pval.coord = c(0.1, 0.04), #P-value position
  conf.int = FALSE,         # show confidence intervals for 
  # point estimates of survival curves.
  palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
  xlim = c(0,10),         # present narrower X axis, but not affect
  # survival estimates.
  xlab = "Time in years",   # customize X axis label.
  break.time.by = 1,     # break X axis in time intervals by 500.
  ggtheme = theme_classic2(), # customize plot and risk table with a theme.
  risk.table.y.text.col = T,# colour risk table text annotations.
  risk.table.height = 0.25, # the height of the risk table
  risk.table.y.text = FALSE,# show bars instead of names in text annotations
  # in legend of risk table.
  ncensor.plot = FALSE,      # plot the number of censored subjects at time t
  legend.labs = c(">4-log reduction", "<4-log reduction"),    # change legend labels.
  legend.title = element_blank() # Remove the legend title
)
ggsurv$plot <- ggsurv$plot + 
  theme(
    legend.text = element_text(size = 14, color = "black", face = "plain"),
    axis.title.x = element_text(size = 14, margin = margin(t = 15)),  # Adjust the margin here
    axis.text.x = element_text(size = 14),
    axis.title.y = element_text(size = 14, margin = margin(r = 15)),  # Adjust the margin here
    axis.text.y = element_text(size = 14),
    #legend.position = c(0.88, 0.1),  # Position bottom right hand corner
    legend.position = c(0.88, 0.95),  # Position top right hand corner
    #disable both for standard legend (top center)
  )
ggsurv$table <- ggsurv$table +
  theme(plot.title = element_text(size = 14, color = "black", face = "bold"),
        axis.text = element_text(size = 14), # Add this line to set font size for axis text
        legend.text = element_text(size = 14, face = "plain")  # Corrected placement of 'face'
  )
ggsurv
```
Calculate the p value with logrank test and Cox regression.
```{r}
survdiff(Surv(RFS_years, RFS_status)~t2cohort$FC_gr3_t2, data=t2cohort)
coxph(Surv(RFS_years, RFS_status) ~ t2cohort$FC_gr3_t2, data=t2cohort) %>% 
  tbl_regression(exp = TRUE)
```
CIR t2cohort,  FC_gr3_t2 Fold Change <10000 vs >10000 (4-log)
```{r}
ci.all<-cuminc(ftime=t2cohort$RFS_years,fstatus=t2cohort$CIR_event,group=t2cohort$FC_gr3_t2)
print(ci.all)
# select subset only CIR, no NRM [3:4]
fig<- ggcompetingrisks( fit =ci.all,
gnames = NULL,
gsep = " ",
multiple_panels = FALSE,
coef = 1.96,
conf.int = FALSE,
pval=TRUE,
palette = c(rgb(120, 110, 100, maxColorValue = 255), rgb(240, 60, 20, maxColorValue = 255)), # Change colors to RGB format
xlim=c(0,10),
ylim=c(0,1),
xlab = "Years", 
ylab = "Probability")
fig<-fig+scale_color_manual(name="", values=c("#786E64","#F03C14"), labels=c(">4-log reduction", "<4-log reduction"))
fig<-fig+scale_x_continuous(breaks=c(0, 2, 4, 6, 8, 10))
fig<-fig+geom_step(linewidth = 1.5)
fig<-fig+theme_classic2()+theme(legend.position = "top")
fig$mapping <- aes(x = time, y = est, colour = group, linetype = event)
print(fig)

fine_gray_test <- crr(t2cohort$RFS_years, t2cohort$CIR_event == 1, t2cohort$FC_gr3_t2)
summary(fine_gray_test)

```


Repeat for all subsets.
For the comparisons which are significant in univariate analysis we can then calculate the multivariate analysis for this. Missing data has to be imputed. The easiest way to do that is ti use the mean of each continuous variable and the median of each categorial variable.
Then we will run a Cox regression on each variable and choose the ones with Pâ¤ 0.1 for the multivariate model. df is now the imputated df, keep separate from full df.

```{r}
df$Age_60<-as.numeric(df$Age_60)
table(df$Age_60)
coxph(Surv(OS_years, OS_status) ~ Age_60, data = df) %>% 
  tbl_regression(exp = TRUE)
coxph(Surv(RFS_years, RFS_status) ~ Age_60, data = df) %>% 
  tbl_regression(exp = TRUE)

df$WBC_median <- ifelse(df$WBC_at_ED > "median", "0", "1")
table(df$WBC_median)
df$WBC_median<-as.numeric(df$WBC_median)
coxph(Surv(OS_years, OS_status) ~WBC_median, data = df) %>% 
  tbl_regression(exp = TRUE)
coxph(Surv(RFS_years, RFS_status) ~ WBC_median, data = df) %>% 
  tbl_regression(exp = TRUE)

```
We have to see which variables to include.
```{r}
coxph(Surv(OS_years, OS_status) ~"v1"+"v2"+..., data = df) %>% 
  tbl_regression(exp = TRUE)
coxph(Surv(RFS_years, RFS_status) ~ "v1"+"v2"+..., data = df) %>% 
  tbl_regression(exp = TRUE)
```
